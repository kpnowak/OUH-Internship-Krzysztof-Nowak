2025-05-26 03:30:52,137 - INFO - Starting MAD analysis pipeline...
2025-05-26 03:30:52,137 - INFO - Step 1: Calculating MAD metrics for all datasets...
2025-05-26 03:30:52,138 - INFO - Processing regression datasets for MAD calculation...
2025-05-26 03:30:52,138 - INFO - Calculating MAD metrics for dataset: AML
2025-05-26 03:30:52,138 - INFO - === LOADING DATASET: AML ===
2025-05-26 03:30:52,138 - INFO - Modalities: ['exp', 'mirna', 'methy']
2025-05-26 03:30:52,138 - INFO - Outcome column: lab_procedure_bone_marrow_blast_cell_outcome_percent_value
2025-05-26 03:30:52,138 - INFO - Task type: regression
2025-05-26 03:30:52,138 - INFO - Loading clinical data from: data\clinical\aml.csv
2025-05-26 03:30:52,146 - INFO - Successfully parsed clinical data with strategy 1
2025-05-26 03:30:52,146 - INFO - Clinical data shape: (200, 97)
2025-05-26 03:30:52,147 - INFO - Clinical data columns: ['FISH_test_component', 'FISH_test_component_percentage_value', '_EVENT', '_INTEGRATION', '_OS', '_OS_IND', '_OS_UNIT', '_PANCAN_CNA_PANCAN_K8', '_PANCAN_Cluster_Cluster_PANCAN', '_PANCAN_DNAMethyl_LAML']...
2025-05-26 03:30:52,147 - INFO - Outcome data shape: (200,)
2025-05-26 03:30:52,148 - INFO - Outcome value counts: {0: 36, 6: 8, 10: 5, 90: 5, 2: 4, 91: 4, 7: 4, 48: 4, 17: 4, 71: 3, 61: 3, 14: 3, 11: 3, 16: 3, 22: 3, 55: 3, 39: 3, 32: 3, 5: 3, 49: 3, 18: 3, 88: 3, 70: 3, 8: 3, 53: 3, 97: 2, 52: 2, 50: 2, 59: 2, 51: 2, 9: 2, 86: 2, 74: 2, 83: 2, 29: 2, 45: 2, 72: 2, 54: 2, 85: 2, 40: 2, 87: 2, 4: 2, 84: 2, 67: 2, 12: 2, 79: 2, 3: 2, 56: 2, 41: 2, 65: 2, 37: 2, 13: 1, 96: 1, 57: 1, 35: 1, 58: 1, 24: 1, 81: 1, 62: 1, 64: 1, 80: 1, 28: 1, 25: 1, 15: 1, 94: 1, 23: 1, 98: 1, 82: 1, 34: 1, 68: 1, 30: 1, 76: 1, 43: 1, 33: 1, 46: 1, 42: 1, 63: 1}
2025-05-26 03:30:52,148 - INFO - Samples with valid outcomes: 200
2025-05-26 03:30:52,148 - INFO - Loading 3 modalities in parallel...
2025-05-26 03:30:52,149 - INFO - Loading exp modality...
2025-05-26 03:30:52,149 - INFO - Loading mirna modality...
2025-05-26 03:30:52,149 - INFO - Loading methy modality...
2025-05-26 03:30:52,150 - INFO - Detected malformed header in exp, attempting repair
2025-05-26 03:30:52,150 - INFO - Attempting to repair malformed exp file
2025-05-26 03:30:52,150 - INFO - Attempting to repair malformed exp file: data\aml\exp.csv
2025-05-26 03:30:52,150 - INFO - Detected malformed header in mirna, attempting repair
2025-05-26 03:30:52,151 - INFO - Attempting to repair malformed mirna file
2025-05-26 03:30:52,151 - INFO - Detected malformed header in methy, attempting repair
2025-05-26 03:30:52,151 - INFO - Attempting to repair malformed mirna file: data\aml\mirna.csv
2025-05-26 03:30:52,151 - INFO - Attempting to repair malformed methy file
2025-05-26 03:30:52,151 - INFO - Attempting to repair malformed methy file: data\aml\methy.csv
2025-05-26 03:30:52,159 - INFO - Found 188 sample IDs in malformed header
2025-05-26 03:30:52,231 - INFO - Successfully repaired malformed mirna file: (705, 188)
2025-05-26 03:30:52,232 - INFO - Data quality check for mirna: PASS - No issues found
2025-05-26 03:30:52,232 - INFO - Loaded mirna data: shape=(705, 188)
2025-05-26 03:30:52,233 - INFO - Standardizing sample IDs for mirna
2025-05-26 03:30:52,234 - INFO - Standardized 188 sample IDs in mirna
2025-05-26 03:30:52,234 - INFO - Applying genomic preprocessing for mirna
2025-05-26 03:30:52,238 - INFO - Removing 144 constant features from mirna
2025-05-26 03:30:52,241 - INFO - Found 194 sample IDs in malformed header
2025-05-26 03:30:52,241 - INFO - Applying log2(x+1) transformation to mirna
2025-05-26 03:30:52,309 - INFO - Found 173 sample IDs in malformed header
2025-05-26 03:30:52,317 - INFO - Memory optimization for mirna: 0.8MB -> 0.4MB (saved 0.4MB)
2025-05-26 03:30:52,318 - INFO - Final mirna data: 561 features x 188 samples
2025-05-26 03:30:52,319 - INFO - Memory usage: 0.4MB
2025-05-26 03:30:52,322 - INFO - mirna modality loaded successfully: (561, 188)
2025-05-26 03:30:52,323 - INFO - [OK] mirna: 561 features x 188 samples
2025-05-26 03:30:52,913 - INFO - Successfully repaired malformed methy file: (5000, 194)
2025-05-26 03:30:52,915 - INFO - Data quality check for methy: PASS - No issues found
2025-05-26 03:30:52,916 - INFO - Loaded methy data: shape=(5000, 194)
2025-05-26 03:30:52,916 - INFO - Standardizing sample IDs for methy
2025-05-26 03:30:52,917 - INFO - Standardized 194 sample IDs in methy
2025-05-26 03:30:52,918 - INFO - Applying genomic preprocessing for methy
2025-05-26 03:30:52,982 - INFO - Memory optimization for methy: 7.8MB -> 4.1MB (saved 3.7MB)
2025-05-26 03:30:52,982 - INFO - Final methy data: 5000 features x 194 samples
2025-05-26 03:30:52,984 - INFO - Memory usage: 4.1MB
2025-05-26 03:30:52,988 - INFO - methy modality loaded successfully: (5000, 194)
2025-05-26 03:30:52,989 - INFO - [OK] methy: 5000 features x 194 samples
2025-05-26 03:30:53,171 - INFO - Successfully repaired malformed exp file: (20531, 173)
2025-05-26 03:30:53,177 - INFO - Data quality check for exp: PASS - No issues found
2025-05-26 03:30:53,177 - INFO - Loaded exp data: shape=(20531, 173)
2025-05-26 03:30:53,178 - INFO - Standardizing sample IDs for exp
2025-05-26 03:30:53,183 - INFO - Standardized 173 sample IDs in exp
2025-05-26 03:30:53,185 - INFO - Applying genomic preprocessing for exp
2025-05-26 03:30:53,237 - INFO - Removing 591 constant features from exp
2025-05-26 03:30:53,296 - INFO - Memory optimization for exp: 27.5MB -> 14.3MB (saved 13.2MB)
2025-05-26 03:30:53,297 - INFO - Applying variance filtering to exp, keeping top 5000 features
2025-05-26 03:30:53,354 - INFO - Final exp data: 5000 features x 173 samples
2025-05-26 03:30:53,358 - INFO - Memory usage: 3.6MB
2025-05-26 03:30:53,361 - INFO - exp modality loaded successfully: (5000, 173)
2025-05-26 03:30:53,361 - INFO - [OK] exp: 5000 features x 173 samples
2025-05-26 03:30:53,362 - INFO - === OPTIMIZED SAMPLE INTERSECTION ANALYSIS ===
2025-05-26 03:30:53,362 - INFO - Starting with 200 samples from outcome data
2025-05-26 03:30:53,362 - INFO - Processing mirna: 188 samples
2025-05-26 03:30:53,362 - INFO - After intersecting with mirna: 188 common samples (lost 12)
2025-05-26 03:30:53,363 - INFO - Processing methy: 194 samples
2025-05-26 03:30:53,363 - INFO - After intersecting with methy: 185 common samples (lost 3)
2025-05-26 03:30:53,363 - INFO - Processing exp: 173 samples
2025-05-26 03:30:53,363 - INFO - After intersecting with exp: 170 common samples (lost 15)
2025-05-26 03:30:53,363 - INFO - === FINAL INTERSECTION SUMMARY ===
2025-05-26 03:30:53,363 - INFO - Original outcome samples: 200
2025-05-26 03:30:53,363 - INFO - Final common samples: 170
2025-05-26 03:30:53,364 - INFO - Sample retention rate: 85.0%
2025-05-26 03:30:53,366 - INFO - Filtered mirna: 561 features x 170 samples
2025-05-26 03:30:53,370 - INFO - Filtered methy: 5000 features x 170 samples
2025-05-26 03:30:53,374 - INFO - Filtered exp: 5000 features x 170 samples
2025-05-26 03:30:53,374 - INFO - EXCELLENT sample retention achieved!
2025-05-26 03:30:53,375 - INFO - \n=== FINAL DATASET STATISTICS ===
2025-05-26 03:30:53,375 - INFO - Common samples found: 170
2025-05-26 03:30:53,375 - INFO - Modalities loaded: ['mirna', 'methy', 'exp']
2025-05-26 03:30:53,375 - INFO - Sample retention rate: 85.0%
2025-05-26 03:30:53,375 - INFO - \n=== REGRESSION DATA FILTERING ===
2025-05-26 03:30:53,376 - INFO - y_series type before filtering: <class 'pandas.core.series.Series'>
2025-05-26 03:30:53,376 - INFO - y_series dtype before filtering: int64
2025-05-26 03:30:53,376 - INFO - y_optimized type after filtering: <class 'pandas.core.series.Series'>
2025-05-26 03:30:53,376 - INFO - y_optimized dtype after filtering: int64
2025-05-26 03:30:53,377 - INFO - Final outcome data filtered to 170 samples matching common_ids
2025-05-26 03:30:53,377 - INFO - Final outcome distribution: {0: 26, 6: 6, 90: 5, 10: 4, 17: 4, 2: 4, 5: 3, 39: 3, 71: 3, 8: 3, 61: 3, 7: 3, 91: 3, 14: 3, 22: 3, 11: 3, 88: 3, 18: 3, 32: 3, 70: 3, 49: 3, 48: 3, 55: 3, 59: 2, 45: 2, 56: 2, 97: 2, 86: 2, 29: 2, 83: 2, 85: 2, 16: 2, 72: 2, 50: 2, 54: 2, 65: 2, 67: 2, 4: 2, 41: 2, 84: 2, 53: 2, 87: 2, 79: 2, 40: 2, 35: 1, 81: 1, 58: 1, 13: 1, 80: 1, 24: 1, 37: 1, 25: 1, 62: 1, 12: 1, 52: 1, 64: 1, 96: 1, 9: 1, 57: 1, 74: 1, 94: 1, 98: 1, 82: 1, 51: 1, 34: 1, 68: 1, 76: 1, 3: 1, 43: 1, 46: 1, 33: 1, 63: 1}
2025-05-26 03:30:53,378 - INFO - All values were already numeric, updated y_filtered to ensure proper dtype
2025-05-26 03:30:53,379 - INFO - Regression validation - Target stats: mean=39.076, std=32.428
2025-05-26 03:30:53,379 - INFO - Target range: [0.000, 98.000]
2025-05-26 03:30:53,379 - INFO - === DATASET AML LOADED SUCCESSFULLY ===
2025-05-26 03:30:53,382 - INFO - MAD for AML mirna: 0.436554
2025-05-26 03:30:53,406 - INFO - MAD for AML methy: 0.241476
2025-05-26 03:30:53,428 - INFO - MAD for AML exp: 367.234955
2025-05-26 03:30:53,430 - INFO - Calculating MAD metrics for dataset: Sarcoma
2025-05-26 03:30:53,430 - INFO - === LOADING DATASET: SARCOMA ===
2025-05-26 03:30:53,430 - INFO - Modalities: ['exp', 'mirna', 'methy']
2025-05-26 03:30:53,431 - INFO - Outcome column: pathologic_tumor_length
2025-05-26 03:30:53,431 - INFO - Task type: regression
2025-05-26 03:30:53,431 - INFO - Loading clinical data from: data\clinical\sarcoma.csv
2025-05-26 03:30:53,441 - INFO - Successfully parsed clinical data with strategy 1
2025-05-26 03:30:53,441 - INFO - Clinical data shape: (271, 114)
2025-05-26 03:30:53,441 - INFO - Clinical data columns: ['_EVENT', '_INTEGRATION', '_OS', '_OS_IND', '_OS_UNIT', '_PATIENT', '_RFS', '_RFS_IND', '_RFS_UNIT', '_TIME_TO_EVENT']...
2025-05-26 03:30:53,442 - INFO - Outcome data shape: (271,)
2025-05-26 03:30:53,442 - INFO - Outcome value counts: {'9': 10, '20': 10, '10': 9, '17': 7, '15': 6, '7': 6, '8.5': 6, '5': 5, '30': 5, '18': 5, '6': 4, '11': 4, '12': 4, '7.0': 4, '19': 4, '22': 4, '13.5': 4, '14': 4, '8': 4, '11.5': 4, '6.5': 4, '9.5': 4, '6.3': 3, '8.0': 3, '3.5': 3, '21': 3, '4.2': 3, '9.2': 3, '13': 3, '4': 3, '5.0': 2, '17.2': 2, '7.9': 2, '12.5': 2, '3.2': 2, '14.5': 2, '26': 2, '7.1': 2, '13.5|7.2': 2, '25': 2, '10.5': 2, '5.5': 2, '16': 2, '7.5': 2, '27': 2, '2.7': 2, '6.4': 2, '2': 2, '20|13|11': 1, '32': 1, '3.5|0.9': 1, '15.2': 1, '10.2': 1, '13.7': 1, '8.5|1.2': 1, '7.6': 1, '29.5': 1, '17.5': 1, '1.2': 1, '8.1': 1, '18.5': 1, '5.4': 1, '10.1': 1, '3.9': 1, '4.9': 1, '13.2': 1, '18.8': 1, '1.6': 1, '19.3': 1, '2.2': 1, '3.8': 1, '10.0': 1, '5.5|1.0': 1, '12.8': 1, '9.0': 1, '5.2': 1, '15.3': 1, '4.0': 1, '0.5|1.5|1.5': 1, '11.1': 1, '36.5': 1, '7.2': 1, '15.1': 1, '20|0.3|11': 1, '8.5|0.9': 1, '4.5': 1, '4.5|3.5': 1, '8.5|8.5|4': 1, '10.6': 1, '18.2': 1, '13.2|3.2|3.0|2.0': 1, '31': 1, '29': 1, '13|1': 1, '3.7|2.9|5|2': 1, '8|12': 1, '19.5': 1, '8.5|3.5': 1, '39.5': 1, '12.6': 1, '24.5': 1, '33|1.4|5.0': 1, '2.6': 1, '14.9': 1, '6.6': 1, '4.1': 1, '36': 1, '7.1|6.2|5.7': 1, '27.5': 1, '12.4': 1, '19.7': 1, '12.3': 1, '10.9': 1, '5.6': 1, '12.9': 1, '8.8': 1, '9.7': 1, '22|5.2': 1, '13.0|2.3': 1, '6.0|3.0|6.5': 1, '11.6': 1, '4.4': 1, '9.1': 1, '11.8': 1, '10.8|6': 1, '38.3|8.5|4.5': 1, '28': 1, '3.0|1.0|23.0|18.0': 1, '14.7': 1}
2025-05-26 03:30:53,443 - INFO - Samples with valid outcomes: 258
2025-05-26 03:30:53,443 - INFO - Loading 3 modalities in parallel...
2025-05-26 03:30:53,444 - INFO - Loading exp modality...
2025-05-26 03:30:53,444 - INFO - Loading mirna modality...
2025-05-26 03:30:53,444 - INFO - Loading methy modality...
2025-05-26 03:30:53,445 - INFO - Detected malformed header in exp, attempting repair
2025-05-26 03:30:53,445 - INFO - Detected malformed header in mirna, attempting repair
2025-05-26 03:30:53,445 - INFO - Attempting to repair malformed exp file
2025-05-26 03:30:53,445 - INFO - Attempting to repair malformed mirna file
2025-05-26 03:30:53,445 - INFO - Attempting to repair malformed exp file: data\sarcoma\exp.csv
2025-05-26 03:30:53,445 - INFO - Attempting to repair malformed mirna file: data\sarcoma\mirna.csv
2025-05-26 03:30:53,445 - INFO - Detected malformed header in methy, attempting repair
2025-05-26 03:30:53,446 - INFO - Attempting to repair malformed methy file
2025-05-26 03:30:53,446 - INFO - Attempting to repair malformed methy file: data\sarcoma\methy.csv
2025-05-26 03:30:53,454 - INFO - Found 263 sample IDs in malformed header
2025-05-26 03:30:53,566 - INFO - Successfully repaired malformed mirna file: (1046, 263)
2025-05-26 03:30:53,566 - INFO - Found 269 sample IDs in malformed header
2025-05-26 03:30:53,567 - INFO - Data quality check for mirna: PASS - No issues found
2025-05-26 03:30:53,567 - INFO - Loaded mirna data: shape=(1046, 263)
2025-05-26 03:30:53,568 - INFO - Standardizing sample IDs for mirna
2025-05-26 03:30:53,569 - INFO - Standardized 263 sample IDs in mirna
2025-05-26 03:30:53,570 - INFO - Applying genomic preprocessing for mirna
2025-05-26 03:30:53,577 - INFO - Removing 207 constant features from mirna
2025-05-26 03:30:53,579 - INFO - Applying log2(x+1) transformation to mirna
2025-05-26 03:30:53,697 - INFO - Memory optimization for mirna: 1.7MB -> 0.9MB (saved 0.8MB)
2025-05-26 03:30:53,698 - INFO - Final mirna data: 839 features x 263 samples
2025-05-26 03:30:53,700 - INFO - Memory usage: 0.9MB
2025-05-26 03:30:53,709 - INFO - mirna modality loaded successfully: (839, 263)
2025-05-26 03:30:53,710 - INFO - [OK] mirna: 839 features x 263 samples
2025-05-26 03:30:53,818 - INFO - Found 265 sample IDs in malformed header
2025-05-26 03:30:54,309 - INFO - Successfully repaired malformed methy file: (5000, 269)
2025-05-26 03:30:54,313 - INFO - Data quality check for methy: PASS - No issues found
2025-05-26 03:30:54,313 - INFO - Loaded methy data: shape=(5000, 269)
2025-05-26 03:30:54,314 - INFO - Standardizing sample IDs for methy
2025-05-26 03:30:54,316 - INFO - Standardized 269 sample IDs in methy
2025-05-26 03:30:54,317 - INFO - Applying genomic preprocessing for methy
2025-05-26 03:30:54,635 - INFO - Memory optimization for methy: 10.7MB -> 5.5MB (saved 5.1MB)
2025-05-26 03:30:54,635 - INFO - Final methy data: 5000 features x 269 samples
2025-05-26 03:30:54,638 - INFO - Memory usage: 5.5MB
2025-05-26 03:30:54,644 - INFO - methy modality loaded successfully: (5000, 269)
2025-05-26 03:30:54,645 - INFO - [OK] methy: 5000 features x 269 samples
2025-05-26 03:30:54,996 - INFO - Successfully repaired malformed exp file: (20531, 265)
2025-05-26 03:30:55,004 - INFO - Data quality check for exp: PASS - No issues found
2025-05-26 03:30:55,005 - INFO - Loaded exp data: shape=(20531, 265)
2025-05-26 03:30:55,006 - INFO - Standardizing sample IDs for exp
2025-05-26 03:30:55,013 - INFO - Standardized 265 sample IDs in exp
2025-05-26 03:30:55,015 - INFO - Applying genomic preprocessing for exp
2025-05-26 03:30:55,092 - INFO - Removing 308 constant features from exp
2025-05-26 03:30:55,181 - INFO - Memory optimization for exp: 42.1MB -> 21.6MB (saved 20.4MB)
2025-05-26 03:30:55,181 - INFO - Applying variance filtering to exp, keeping top 5000 features
2025-05-26 03:30:55,267 - INFO - Final exp data: 5000 features x 265 samples
2025-05-26 03:30:55,271 - INFO - Memory usage: 5.3MB
2025-05-26 03:30:55,277 - INFO - exp modality loaded successfully: (5000, 265)
2025-05-26 03:30:55,277 - INFO - [OK] exp: 5000 features x 265 samples
2025-05-26 03:30:55,277 - INFO - === OPTIMIZED SAMPLE INTERSECTION ANALYSIS ===
2025-05-26 03:30:55,278 - INFO - Starting with 258 samples from outcome data
2025-05-26 03:30:55,278 - INFO - Processing mirna: 263 samples
2025-05-26 03:30:55,278 - INFO - After intersecting with mirna: 251 common samples (lost 7)
2025-05-26 03:30:55,279 - INFO - Processing methy: 269 samples
2025-05-26 03:30:55,279 - INFO - After intersecting with methy: 251 common samples (lost 0)
2025-05-26 03:30:55,279 - INFO - Processing exp: 265 samples
2025-05-26 03:30:55,279 - INFO - After intersecting with exp: 249 common samples (lost 2)
2025-05-26 03:30:55,279 - INFO - === FINAL INTERSECTION SUMMARY ===
2025-05-26 03:30:55,280 - INFO - Original outcome samples: 258
2025-05-26 03:30:55,280 - INFO - Final common samples: 249
2025-05-26 03:30:55,280 - INFO - Sample retention rate: 96.5%
2025-05-26 03:30:55,283 - INFO - Filtered mirna: 839 features x 249 samples
2025-05-26 03:30:55,288 - INFO - Filtered methy: 5000 features x 249 samples
2025-05-26 03:30:55,295 - INFO - Filtered exp: 5000 features x 249 samples
2025-05-26 03:30:55,295 - INFO - EXCELLENT sample retention achieved!
2025-05-26 03:30:55,295 - INFO - \n=== FINAL DATASET STATISTICS ===
2025-05-26 03:30:55,296 - INFO - Common samples found: 249
2025-05-26 03:30:55,296 - INFO - Modalities loaded: ['mirna', 'methy', 'exp']
2025-05-26 03:30:55,296 - INFO - Sample retention rate: 96.5%
2025-05-26 03:30:55,296 - INFO - \n=== REGRESSION DATA FILTERING ===
2025-05-26 03:30:55,296 - INFO - y_series type before filtering: <class 'pandas.core.series.Series'>
2025-05-26 03:30:55,297 - INFO - y_series dtype before filtering: object
2025-05-26 03:30:55,297 - INFO - y_optimized type after filtering: <class 'pandas.core.series.Series'>
2025-05-26 03:30:55,297 - INFO - y_optimized dtype after filtering: object
2025-05-26 03:30:55,298 - INFO - Final outcome data filtered to 249 samples matching common_ids
2025-05-26 03:30:55,298 - INFO - Final outcome distribution: {'20': 10, '9': 10, '10': 8, '17': 7, '15': 6, '7': 6, '5': 5, '18': 5, '8.5': 5, '30': 5, '12': 4, '6': 4, '11': 4, '19': 4, '22': 4, '13.5': 4, '8': 4, '6.5': 4, '9.5': 4, '14': 3, '4': 3, '6.3': 3, '7.0': 3, '9.2': 3, '4.2': 3, '11.5': 3, '3.5': 3, '8.0': 3, '5.0': 2, '17.2': 2, '14.5': 2, '16': 2, '2.7': 2, '5.5': 2, '3.2': 2, '25': 2, '7.1': 2, '26': 2, '10.5': 2, '13': 2, '27': 2, '7.5': 2, '6.4': 2, '12.5': 2, '21': 2, '2': 2, '7.9': 2, '2.2': 1, '4.9': 1, '5.4': 1, '18.5': 1, '8.1': 1, '1.2': 1, '3.9': 1, '10.1': 1, '8.5|1.2': 1, '20|13|11': 1, '13.7': 1, '13.5|7.2': 1, '15.2': 1, '3.5|0.9': 1, '17.5': 1, '12.8': 1, '29.5': 1, '10.0': 1, '10.2': 1, '32': 1, '3.8': 1, '11.1': 1, '4.0': 1, '7.6': 1, '36.5': 1, '9.0': 1, '5.5|1.0': 1, '15.3': 1, '0.5|1.5|1.5': 1, '18.8': 1, '1.6': 1, '13.2': 1, '5.2': 1, '6.0|3.0|6.5': 1, '19.3': 1, '20|0.3|11': 1, '8.5|0.9': 1, '4.5': 1, '4.5|3.5': 1, '8.5|8.5|4': 1, '10.6': 1, '18.2': 1, '13.2|3.2|3.0|2.0': 1, '31': 1, '29': 1, '13|1': 1, '3.7|2.9|5|2': 1, '8|12': 1, '19.5': 1, '8.5|3.5': 1, '39.5': 1, '12.6': 1, '24.5': 1, '33|1.4|5.0': 1, '2.6': 1, '14.9': 1, '6.6': 1, '4.1': 1, '15.1': 1, '9.7': 1, '36': 1, '27.5': 1, '12.4': 1, '19.7': 1, '12.3': 1, '10.9': 1, '5.6': 1, '12.9': 1, '8.8': 1, '7.1|6.2|5.7': 1, '13.0|2.3': 1, '22|5.2': 1, '11.6': 1, '7.2': 1, '4.4': 1, '9.1': 1, '10.8|6': 1, '38.3|8.5|4.5': 1, '28': 1, '3.0|1.0|23.0|18.0': 1, '14.7': 1}
2025-05-26 03:30:55,299 - INFO - Found 23 pipe-separated values in regression outcome column 'pathologic_tumor_length'
2025-05-26 03:30:55,299 - INFO - Sample pipe-separated values: ['33|1.4|5.0', '8.5|3.5', '8|12', '13|1', '20|0.3|11']
2025-05-26 03:30:55,299 - INFO - Attempting to extract maximum numeric values from pipe-separated entries...
2025-05-26 03:30:55,300 - INFO - Successfully extracted 23 additional numeric values
2025-05-26 03:30:55,300 - INFO - Updated y_filtered to numeric version (no samples removed)
2025-05-26 03:30:55,301 - INFO - Regression validation - Target stats: mean=12.551, std=7.690
2025-05-26 03:30:55,301 - INFO - Target range: [1.200, 39.500]
2025-05-26 03:30:55,302 - INFO - === DATASET SARCOMA LOADED SUCCESSFULLY ===
2025-05-26 03:30:55,309 - INFO - MAD for Sarcoma mirna: 0.206104
2025-05-26 03:30:55,343 - INFO - MAD for Sarcoma methy: 0.250229
2025-05-26 03:30:55,379 - INFO - MAD for Sarcoma exp: 478.041870
2025-05-26 03:30:55,382 - INFO - Processing classification datasets for MAD calculation...
2025-05-26 03:30:55,382 - INFO - Calculating MAD metrics for dataset: Breast
2025-05-26 03:30:55,382 - INFO - === LOADING DATASET: BREAST ===
2025-05-26 03:30:55,382 - INFO - Modalities: ['exp', 'mirna', 'methy']
2025-05-26 03:30:55,382 - INFO - Outcome column: pathologic_T
2025-05-26 03:30:55,383 - INFO - Task type: classification
2025-05-26 03:30:55,383 - INFO - Loading clinical data from: data\clinical\breast.csv
2025-05-26 03:30:55,413 - INFO - Successfully parsed clinical data with strategy 1
2025-05-26 03:30:55,413 - INFO - Clinical data shape: (1247, 202)
2025-05-26 03:30:55,413 - INFO - Clinical data columns: ['AJCC_Stage_nature2012', 'Age_at_Initial_Pathologic_Diagnosis_nature2012', 'CN_Clusters_nature2012', 'Converted_Stage_nature2012', 'Days_to_Date_of_Last_Contact_nature2012', 'Days_to_date_of_Death_nature2012', 'ER_Status_nature2012', 'Gender_nature2012', 'HER2_Final_Status_nature2012', 'Integrated_Clusters_no_exp__nature2012']...
2025-05-26 03:30:55,414 - INFO - Outcome data shape: (1247,)
2025-05-26 03:30:55,414 - INFO - Outcome value counts: {'T2': 720, 'T1c': 253, 'T3': 150, 'T1': 45, 'T4b': 34, 'T1b': 18, 'T4': 9, 'T4d': 4, 'TX': 3, 'T2b': 2, 'T1a': 2, 'T3a': 1, 'T2a': 1}
2025-05-26 03:30:55,415 - INFO - Samples with valid outcomes: 1242
2025-05-26 03:30:55,415 - INFO - Loading 3 modalities in parallel...
2025-05-26 03:30:55,415 - INFO - Loading exp modality...
2025-05-26 03:30:55,416 - INFO - Loading mirna modality...
2025-05-26 03:30:55,416 - INFO - Large file detected (182.9MB), using chunked loading for exp
2025-05-26 03:30:55,416 - INFO - Loading methy modality...
2025-05-26 03:30:55,419 - INFO - Detected malformed header in mirna, attempting repair
2025-05-26 03:30:55,420 - INFO - Attempting to repair malformed mirna file
2025-05-26 03:30:55,420 - INFO - Attempting to repair malformed mirna file: data\breast\mirna.csv
2025-05-26 03:30:55,420 - INFO - Malformed large file detected for exp (1212 TCGA IDs in header), falling back to repair method
2025-05-26 03:30:55,420 - INFO - Detected malformed header in methy, attempting repair
2025-05-26 03:30:55,421 - INFO - Attempting to repair malformed methy file
2025-05-26 03:30:55,421 - INFO - Attempting to repair malformed methy file: data\breast\methy.csv
2025-05-26 03:30:55,421 - INFO - Detected malformed header in exp, attempting repair
2025-05-26 03:30:55,422 - INFO - Attempting to repair malformed exp file
2025-05-26 03:30:55,422 - INFO - Attempting to repair malformed exp file: data\breast\exp.csv
2025-05-26 03:30:55,451 - INFO - Found 849 sample IDs in malformed header
2025-05-26 03:30:55,732 - INFO - Successfully repaired malformed mirna file: (1046, 849)
2025-05-26 03:30:55,736 - INFO - Data quality check for mirna: PASS - No issues found
2025-05-26 03:30:55,736 - INFO - Loaded mirna data: shape=(1046, 849)
2025-05-26 03:30:55,737 - INFO - Standardizing sample IDs for mirna
2025-05-26 03:30:55,738 - INFO - Standardized 849 sample IDs in mirna
2025-05-26 03:30:55,739 - INFO - Applying genomic preprocessing for mirna
2025-05-26 03:30:55,754 - INFO - Removing 149 constant features from mirna
2025-05-26 03:30:55,757 - INFO - Applying log2(x+1) transformation to mirna
2025-05-26 03:30:55,902 - INFO - Found 885 sample IDs in malformed header
2025-05-26 03:30:56,116 - INFO - Memory optimization for mirna: 5.9MB -> 3.0MB (saved 2.9MB)
2025-05-26 03:30:56,117 - INFO - Final mirna data: 897 features x 849 samples
2025-05-26 03:30:56,122 - INFO - Memory usage: 3.0MB
2025-05-26 03:30:56,143 - INFO - mirna modality loaded successfully: (897, 849)
2025-05-26 03:30:56,144 - INFO - [OK] mirna: 897 features x 849 samples
2025-05-26 03:30:56,685 - INFO - Found 1212 sample IDs in malformed header
2025-05-26 03:30:58,856 - INFO - Successfully repaired malformed methy file: (5000, 885)
2025-05-26 03:30:58,865 - INFO - Data quality check for methy: PASS - No issues found
2025-05-26 03:30:58,866 - INFO - Loaded methy data: shape=(5000, 885)
2025-05-26 03:30:58,867 - INFO - Standardizing sample IDs for methy
2025-05-26 03:30:58,874 - INFO - Standardized 885 sample IDs in methy
2025-05-26 03:30:58,875 - INFO - Applying genomic preprocessing for methy
2025-05-26 03:30:59,410 - INFO - Memory optimization for methy: 34.2MB -> 17.3MB (saved 16.9MB)
2025-05-26 03:30:59,410 - INFO - Final methy data: 5000 features x 885 samples
2025-05-26 03:30:59,417 - INFO - Memory usage: 17.3MB
2025-05-26 03:30:59,521 - INFO - methy modality loaded successfully: (5000, 885)
2025-05-26 03:30:59,522 - INFO - [OK] methy: 5000 features x 885 samples
2025-05-26 03:31:03,066 - INFO - Successfully repaired malformed exp file: (20531, 1212)
2025-05-26 03:31:03,097 - INFO - Data quality check for exp: PASS - No issues found
2025-05-26 03:31:03,097 - INFO - Loaded exp data: shape=(20531, 1212)
2025-05-26 03:31:03,099 - INFO - Standardizing sample IDs for exp
2025-05-26 03:31:03,132 - INFO - Standardized 1212 sample IDs in exp
2025-05-26 03:31:03,134 - INFO - Applying genomic preprocessing for exp
2025-05-26 03:31:03,619 - INFO - Removing 278 constant features from exp
2025-05-26 03:31:04,166 - INFO - Memory optimization for exp: 188.4MB -> 94.8MB (saved 93.6MB)
2025-05-26 03:31:04,167 - INFO - Applying variance filtering to exp, keeping top 5000 features
2025-05-26 03:31:04,616 - INFO - Final exp data: 5000 features x 1212 samples
2025-05-26 03:31:04,631 - INFO - Memory usage: 23.4MB
2025-05-26 03:31:04,663 - INFO - exp modality loaded successfully: (5000, 1212)
2025-05-26 03:31:04,664 - INFO - [OK] exp: 5000 features x 1212 samples
2025-05-26 03:31:04,664 - INFO - === OPTIMIZED SAMPLE INTERSECTION ANALYSIS ===
2025-05-26 03:31:04,664 - INFO - Starting with 1242 samples from outcome data
2025-05-26 03:31:04,665 - INFO - Processing mirna: 849 samples
2025-05-26 03:31:04,665 - INFO - After intersecting with mirna: 849 common samples (lost 393)
2025-05-26 03:31:04,665 - INFO - Attempting sample recovery for mirna (lost 393 samples)
2025-05-26 03:31:10,371 - INFO - Fuzzy matching found 375 recoverable samples
2025-05-26 03:31:10,382 - INFO - Pattern matching found 44 additional recoverable samples
2025-05-26 03:31:10,383 - INFO - Processing methy: 885 samples
2025-05-26 03:31:10,384 - INFO - After intersecting with methy: 679 common samples (lost 170)
2025-05-26 03:31:10,384 - INFO - Attempting sample recovery for methy (lost 170 samples)
2025-05-26 03:31:12,962 - INFO - Fuzzy matching found 170 recoverable samples
2025-05-26 03:31:12,986 - INFO - Pattern matching found 16 additional recoverable samples
2025-05-26 03:31:12,990 - INFO - Processing exp: 1212 samples
2025-05-26 03:31:12,991 - INFO - After intersecting with exp: 702 common samples (lost 17)
2025-05-26 03:31:12,991 - INFO - Sample recovery successful: 605 samples recovered across all modalities
2025-05-26 03:31:12,991 - INFO - === FINAL INTERSECTION SUMMARY ===
2025-05-26 03:31:12,991 - INFO - Original outcome samples: 1242
2025-05-26 03:31:12,991 - INFO - Final common samples: 702
2025-05-26 03:31:12,991 - INFO - Sample retention rate: 56.5%
2025-05-26 03:31:12,993 - INFO - Filtered mirna: 897 features x 702 samples
2025-05-26 03:31:12,997 - INFO - Filtered methy: 5000 features x 702 samples
2025-05-26 03:31:13,011 - INFO - Filtered exp: 5000 features x 702 samples
2025-05-26 03:31:13,011 - WARNING - MODERATE SAMPLE RETENTION detected!
2025-05-26 03:31:13,012 - INFO - MODERATE sample retention detected (this is normal for TCGA data)
2025-05-26 03:31:13,012 - INFO - EXPLANATION: Sample loss occurs due to:
2025-05-26 03:31:13,012 - INFO - 1. ID format differences between clinical and expression data
2025-05-26 03:31:13,012 - INFO - 2. Malformed data files requiring repair
2025-05-26 03:31:13,013 - INFO - 3. Quality filtering and class optimization
2025-05-26 03:31:13,015 - INFO - The system has already applied advanced recovery strategies
2025-05-26 03:31:13,015 - INFO - \n=== FINAL DATASET STATISTICS ===
2025-05-26 03:31:13,015 - INFO - Common samples found: 702
2025-05-26 03:31:13,015 - INFO - Modalities loaded: ['mirna', 'methy', 'exp']
2025-05-26 03:31:13,016 - INFO - Sample retention rate: 56.5%
2025-05-26 03:31:13,016 - INFO - \n=== CLASS DISTRIBUTION OPTIMIZATION ===
2025-05-26 03:31:13,017 - INFO - Original class distribution: {'T2': 404, 'T1c': 145, 'T3': 87, 'T1': 29, 'T4b': 17, 'T1b': 9, 'T4': 4, 'T4d': 3, 'T1a': 2, 'TX': 1, 'T3a': 1}
2025-05-26 03:31:13,017 - INFO - Classes with <5 samples: ['T4', 'T4d', 'T1a', 'TX', 'T3a']
2025-05-26 03:31:13,018 - INFO - Merged ['T4', 'T4d'] -> T4
2025-05-26 03:31:13,019 - INFO - Removing classes with <5 samples: ['T1a', 'TX', 'T3a']
2025-05-26 03:31:13,022 - INFO - Optimized class distribution: {'T2': 404, 'T1c': 145, 'T3': 87, 'T1': 29, 'T4b': 17, 'T1b': 9, 'T4': 7}
2025-05-26 03:31:13,022 - INFO - Samples retained: 698/702 (99.4%)
2025-05-26 03:31:13,022 - INFO - Updating modalities to match optimized sample set: 698 samples
2025-05-26 03:31:13,098 - INFO - Final outcome data filtered to 698 samples matching common_ids
2025-05-26 03:31:13,099 - INFO - Final outcome distribution: {'T2': 404, 'T1c': 145, 'T3': 87, 'T1': 29, 'T4b': 17, 'T1b': 9, 'T4': 7}
2025-05-26 03:31:13,099 - INFO - Converting string class labels to numeric labels for classification
2025-05-26 03:31:13,101 - INFO - Label mapping: {'T1': 0, 'T1b': 1, 'T1c': 2, 'T2': 3, 'T3': 4, 'T4': 5, 'T4b': 6}
2025-05-26 03:31:13,101 - INFO - Converted to numeric labels: {3: 404, 2: 145, 4: 87, 0: 29, 6: 17, 1: 9, 5: 7}
2025-05-26 03:31:13,102 - INFO - Classification validation: 7 classes, min class size: 7
2025-05-26 03:31:13,102 - INFO - All classes have >=5 samples - excellent for CV!
2025-05-26 03:31:13,102 - INFO - === DATASET BREAST LOADED SUCCESSFULLY ===
2025-05-26 03:31:13,126 - INFO - MAD for Breast mirna: 0.000000
2025-05-26 03:31:13,221 - INFO - MAD for Breast methy: 0.207285
2025-05-26 03:31:13,321 - INFO - MAD for Breast exp: 450.522491
2025-05-26 03:31:13,327 - INFO - Calculating MAD metrics for dataset: Colon
2025-05-26 03:31:13,327 - INFO - === LOADING DATASET: COLON ===
2025-05-26 03:31:13,327 - INFO - Modalities: ['exp', 'mirna', 'methy']
2025-05-26 03:31:13,327 - INFO - Outcome column: pathologic_T
2025-05-26 03:31:13,328 - INFO - Task type: classification
2025-05-26 03:31:13,328 - INFO - Loading clinical data from: data\clinical\colon.csv
2025-05-26 03:31:13,341 - INFO - Successfully parsed clinical data with strategy 1
2025-05-26 03:31:13,342 - INFO - Clinical data shape: (551, 141)
2025-05-26 03:31:13,342 - INFO - Clinical data columns: ['AWG_MLH1_silencing', 'AWG_cancer_type_Oct62011', 'CDE_ID_3226963', 'CIMP', 'MSI_updated_Oct62011', '_EVENT', '_INTEGRATION', '_OS', '_OS_IND', '_OS_UNIT']...
2025-05-26 03:31:13,342 - INFO - Outcome data shape: (551,)
2025-05-26 03:31:13,343 - INFO - Outcome value counts: {'T3': 377, 'T2': 90, 'T4': 36, 'T4a': 20, 'T4b': 11, 'T1': 11, 'Tis': 1}
2025-05-26 03:31:13,343 - INFO - Samples with valid outcomes: 546
2025-05-26 03:31:13,343 - INFO - Loading 3 modalities in parallel...
2025-05-26 03:31:13,344 - INFO - Loading exp modality...
2025-05-26 03:31:13,344 - INFO - Loading mirna modality...
2025-05-26 03:31:13,345 - INFO - Loading methy modality...
2025-05-26 03:31:13,345 - INFO - Detected malformed header in exp, attempting repair
2025-05-26 03:31:13,345 - INFO - Attempting to repair malformed exp file
2025-05-26 03:31:13,346 - INFO - Attempting to repair malformed exp file: data\colon\exp.csv
2025-05-26 03:31:13,347 - INFO - Detected malformed header in mirna, attempting repair
2025-05-26 03:31:13,347 - INFO - Attempting to repair malformed mirna file
2025-05-26 03:31:13,347 - INFO - Attempting to repair malformed mirna file: data\colon\mirna.csv
2025-05-26 03:31:13,351 - INFO - Detected malformed header in methy, attempting repair
2025-05-26 03:31:13,351 - INFO - Attempting to repair malformed methy file
2025-05-26 03:31:13,351 - INFO - Attempting to repair malformed methy file: data\colon\methy.csv
2025-05-26 03:31:13,362 - INFO - Found 221 sample IDs in malformed header
2025-05-26 03:31:13,445 - INFO - Successfully repaired malformed mirna file: (705, 221)
2025-05-26 03:31:13,446 - INFO - Data quality check for mirna: PASS - No issues found
2025-05-26 03:31:13,446 - INFO - Loaded mirna data: shape=(705, 221)
2025-05-26 03:31:13,447 - INFO - Standardizing sample IDs for mirna
2025-05-26 03:31:13,448 - INFO - Standardized 221 sample IDs in mirna
2025-05-26 03:31:13,448 - INFO - Applying genomic preprocessing for mirna
2025-05-26 03:31:13,454 - INFO - Removing 92 constant features from mirna
2025-05-26 03:31:13,455 - INFO - Applying log2(x+1) transformation to mirna
2025-05-26 03:31:13,556 - INFO - Memory optimization for mirna: 1.1MB -> 0.6MB (saved 0.5MB)
2025-05-26 03:31:13,556 - INFO - Final mirna data: 613 features x 221 samples
2025-05-26 03:31:13,558 - INFO - Memory usage: 0.6MB
2025-05-26 03:31:13,565 - INFO - mirna modality loaded successfully: (613, 221)
2025-05-26 03:31:13,566 - INFO - [OK] mirna: 613 features x 221 samples
2025-05-26 03:31:13,577 - INFO - Found 335 sample IDs in malformed header
2025-05-26 03:31:13,656 - INFO - Found 328 sample IDs in malformed header
2025-05-26 03:31:14,647 - INFO - Successfully repaired malformed methy file: (5000, 335)
2025-05-26 03:31:14,650 - INFO - Data quality check for methy: PASS - No issues found
2025-05-26 03:31:14,651 - INFO - Loaded methy data: shape=(5000, 335)
2025-05-26 03:31:14,652 - INFO - Standardizing sample IDs for methy
2025-05-26 03:31:14,655 - INFO - Standardized 335 sample IDs in methy
2025-05-26 03:31:14,656 - INFO - Applying genomic preprocessing for methy
2025-05-26 03:31:14,800 - INFO - Memory optimization for methy: 13.2MB -> 6.8MB (saved 6.4MB)
2025-05-26 03:31:14,800 - INFO - Final methy data: 5000 features x 335 samples
2025-05-26 03:31:14,803 - INFO - Memory usage: 6.8MB
2025-05-26 03:31:14,812 - INFO - methy modality loaded successfully: (5000, 335)
2025-05-26 03:31:14,813 - INFO - [OK] methy: 5000 features x 335 samples
2025-05-26 03:31:15,255 - INFO - Successfully repaired malformed exp file: (20531, 328)
2025-05-26 03:31:15,266 - INFO - Data quality check for exp: PASS - No issues found
2025-05-26 03:31:15,266 - INFO - Loaded exp data: shape=(20531, 328)
2025-05-26 03:31:15,267 - INFO - Standardizing sample IDs for exp
2025-05-26 03:31:15,280 - INFO - Standardized 328 sample IDs in exp
2025-05-26 03:31:15,284 - INFO - Applying genomic preprocessing for exp
2025-05-26 03:31:15,402 - INFO - Removing 480 constant features from exp
2025-05-26 03:31:15,540 - INFO - Memory optimization for exp: 51.3MB -> 26.2MB (saved 25.1MB)
2025-05-26 03:31:15,541 - INFO - Applying variance filtering to exp, keeping top 5000 features
2025-05-26 03:31:15,673 - INFO - Final exp data: 5000 features x 328 samples
2025-05-26 03:31:15,682 - INFO - Memory usage: 6.5MB
2025-05-26 03:31:15,688 - INFO - exp modality loaded successfully: (5000, 328)
2025-05-26 03:31:15,689 - INFO - [OK] exp: 5000 features x 328 samples
2025-05-26 03:31:15,690 - INFO - === OPTIMIZED SAMPLE INTERSECTION ANALYSIS ===
2025-05-26 03:31:15,690 - INFO - Starting with 546 samples from outcome data
2025-05-26 03:31:15,690 - INFO - Processing mirna: 221 samples
2025-05-26 03:31:15,691 - INFO - After intersecting with mirna: 221 common samples (lost 325)
2025-05-26 03:31:15,691 - INFO - Attempting sample recovery for mirna (lost 325 samples)
2025-05-26 03:31:16,959 - INFO - Fuzzy matching found 220 recoverable samples
2025-05-26 03:31:16,963 - INFO - Pattern matching found 28 additional recoverable samples
2025-05-26 03:31:16,964 - INFO - Processing methy: 335 samples
2025-05-26 03:31:16,965 - INFO - After intersecting with methy: 211 common samples (lost 10)
2025-05-26 03:31:16,965 - INFO - Processing exp: 328 samples
2025-05-26 03:31:16,965 - INFO - After intersecting with exp: 204 common samples (lost 7)
2025-05-26 03:31:16,965 - INFO - Sample recovery successful: 248 samples recovered across all modalities
2025-05-26 03:31:16,966 - INFO - === FINAL INTERSECTION SUMMARY ===
2025-05-26 03:31:16,966 - INFO - Original outcome samples: 546
2025-05-26 03:31:16,966 - INFO - Final common samples: 204
2025-05-26 03:31:16,966 - INFO - Sample retention rate: 37.4%
2025-05-26 03:31:16,968 - INFO - Filtered mirna: 613 features x 204 samples
2025-05-26 03:31:16,975 - INFO - Filtered methy: 5000 features x 204 samples
2025-05-26 03:31:16,983 - INFO - Filtered exp: 5000 features x 204 samples
2025-05-26 03:31:16,983 - INFO - Sample retention: 37.4% - Expected low sample retention for this dataset type
2025-05-26 03:31:16,983 - INFO - \n=== FINAL DATASET STATISTICS ===
2025-05-26 03:31:16,983 - INFO - Common samples found: 204
2025-05-26 03:31:16,984 - INFO - Modalities loaded: ['mirna', 'methy', 'exp']
2025-05-26 03:31:16,984 - INFO - Sample retention rate: 37.4%
2025-05-26 03:31:16,984 - INFO - \n=== CLASS DISTRIBUTION OPTIMIZATION ===
2025-05-26 03:31:16,985 - INFO - Original class distribution: {'T3': 148, 'T2': 30, 'T4a': 9, 'T4b': 6, 'T4': 6, 'T1': 4, 'Tis': 1}
2025-05-26 03:31:16,985 - INFO - Classes with <5 samples: ['T1', 'Tis']
2025-05-26 03:31:16,986 - INFO - Removing classes with <5 samples: ['T1', 'Tis']
2025-05-26 03:31:16,987 - INFO - Optimized class distribution: {'T3': 148, 'T2': 30, 'T4a': 9, 'T4b': 6, 'T4': 6}
2025-05-26 03:31:16,988 - INFO - Samples retained: 199/204 (97.5%)
2025-05-26 03:31:16,988 - INFO - Updating modalities to match optimized sample set: 199 samples
2025-05-26 03:31:17,008 - INFO - Final outcome data filtered to 199 samples matching common_ids
2025-05-26 03:31:17,009 - INFO - Final outcome distribution: {'T3': 148, 'T2': 30, 'T4a': 9, 'T4b': 6, 'T4': 6}
2025-05-26 03:31:17,009 - INFO - Converting string class labels to numeric labels for classification
2025-05-26 03:31:17,010 - INFO - Label mapping: {'T2': 0, 'T3': 1, 'T4': 2, 'T4a': 3, 'T4b': 4}
2025-05-26 03:31:17,011 - INFO - Converted to numeric labels: {1: 148, 0: 30, 3: 9, 4: 6, 2: 6}
2025-05-26 03:31:17,012 - INFO - Classification validation: 5 classes, min class size: 6
2025-05-26 03:31:17,012 - INFO - All classes have >=5 samples - excellent for CV!
2025-05-26 03:31:17,012 - INFO - === DATASET COLON LOADED SUCCESSFULLY ===
2025-05-26 03:31:17,020 - INFO - MAD for Colon mirna: 0.341708
2025-05-26 03:31:17,065 - INFO - MAD for Colon methy: 0.199081
2025-05-26 03:31:17,104 - INFO - MAD for Colon exp: 367.757080
2025-05-26 03:31:17,108 - INFO - Calculating MAD metrics for dataset: Kidney
2025-05-26 03:31:17,108 - INFO - === LOADING DATASET: KIDNEY ===
2025-05-26 03:31:17,109 - INFO - Modalities: ['exp', 'mirna', 'methy']
2025-05-26 03:31:17,109 - INFO - Outcome column: pathologic_T
2025-05-26 03:31:17,109 - INFO - Task type: classification
2025-05-26 03:31:17,109 - INFO - Loading clinical data from: data\clinical\kidney.csv
2025-05-26 03:31:17,137 - INFO - Successfully parsed clinical data with strategy 1
2025-05-26 03:31:17,137 - INFO - Clinical data shape: (985, 140)
2025-05-26 03:31:17,137 - INFO - Clinical data columns: ['additional_pharmaceutical_therapy', 'additional_radiation_therapy', 'additional_surgery_locoregional_procedure', 'additional_surgery_metastatic_procedure', 'age_at_initial_pathologic_diagnosis', 'anatomic_treatment_site', 'batch_number', 'bcr', 'bcr_drug_barcode', 'bcr_drug_uuid']...
2025-05-26 03:31:17,138 - INFO - Outcome data shape: (985,)
2025-05-26 03:31:17,139 - INFO - Outcome value counts: {'T1a': 250, 'T3a': 234, 'T1b': 205, 'T3b': 102, 'T2': 101, 'T1': 37, 'T4': 22, 'T2a': 15, 'T2b': 8, 'T3': 7, 'T3c': 4}
2025-05-26 03:31:17,140 - INFO - Samples with valid outcomes: 985
2025-05-26 03:31:17,140 - INFO - Loading 3 modalities in parallel...
2025-05-26 03:31:17,141 - INFO - Loading exp modality...
2025-05-26 03:31:17,142 - INFO - Loading mirna modality...
2025-05-26 03:31:17,142 - INFO - Loading methy modality...
2025-05-26 03:31:17,143 - INFO - Detected malformed header in mirna, attempting repair
2025-05-26 03:31:17,143 - INFO - Attempting to repair malformed mirna file
2025-05-26 03:31:17,144 - INFO - Detected malformed header in methy, attempting repair
2025-05-26 03:31:17,144 - INFO - Detected malformed header in exp, attempting repair
2025-05-26 03:31:17,144 - INFO - Attempting to repair malformed mirna file: data\kidney\mirna.csv
2025-05-26 03:31:17,144 - INFO - Attempting to repair malformed methy file
2025-05-26 03:31:17,144 - INFO - Attempting to repair malformed exp file
2025-05-26 03:31:17,145 - INFO - Attempting to repair malformed methy file: data\kidney\methy.csv
2025-05-26 03:31:17,145 - INFO - Attempting to repair malformed exp file: data\kidney\exp.csv
2025-05-26 03:31:17,170 - INFO - Found 326 sample IDs in malformed header
2025-05-26 03:31:17,320 - INFO - Successfully repaired malformed mirna file: (1046, 326)
2025-05-26 03:31:17,323 - INFO - Data quality check for mirna: PASS - No issues found
2025-05-26 03:31:17,324 - INFO - Loaded mirna data: shape=(1046, 326)
2025-05-26 03:31:17,325 - INFO - Standardizing sample IDs for mirna
2025-05-26 03:31:17,326 - INFO - Standardized 326 sample IDs in mirna
2025-05-26 03:31:17,327 - INFO - Applying genomic preprocessing for mirna
2025-05-26 03:31:17,338 - INFO - Removing 221 constant features from mirna
2025-05-26 03:31:17,341 - INFO - Applying log2(x+1) transformation to mirna
2025-05-26 03:31:17,612 - INFO - Memory optimization for mirna: 2.1MB -> 1.1MB (saved 1.0MB)
2025-05-26 03:31:17,613 - INFO - Final mirna data: 825 features x 326 samples
2025-05-26 03:31:17,617 - INFO - Memory usage: 1.1MB
2025-05-26 03:31:17,642 - INFO - mirna modality loaded successfully: (825, 326)
2025-05-26 03:31:17,642 - INFO - [OK] mirna: 825 features x 326 samples
2025-05-26 03:31:17,696 - INFO - Found 480 sample IDs in malformed header
2025-05-26 03:31:17,876 - INFO - Found 606 sample IDs in malformed header
2025-05-26 03:31:19,211 - INFO - Successfully repaired malformed methy file: (5000, 480)
2025-05-26 03:31:19,217 - INFO - Data quality check for methy: PASS - No issues found
2025-05-26 03:31:19,217 - INFO - Loaded methy data: shape=(5000, 480)
2025-05-26 03:31:19,218 - INFO - Standardizing sample IDs for methy
2025-05-26 03:31:19,223 - INFO - Standardized 480 sample IDs in methy
2025-05-26 03:31:19,224 - INFO - Applying genomic preprocessing for methy
2025-05-26 03:31:19,919 - INFO - Memory optimization for methy: 18.7MB -> 9.6MB (saved 9.2MB)
2025-05-26 03:31:19,920 - INFO - Final methy data: 5000 features x 480 samples
2025-05-26 03:31:19,924 - INFO - Memory usage: 9.6MB
2025-05-26 03:31:19,939 - INFO - methy modality loaded successfully: (5000, 480)
2025-05-26 03:31:19,940 - INFO - [OK] methy: 5000 features x 480 samples
2025-05-26 03:31:21,937 - INFO - Successfully repaired malformed exp file: (20531, 606)
2025-05-26 03:31:21,957 - INFO - Data quality check for exp: PASS - No issues found
2025-05-26 03:31:21,957 - INFO - Loaded exp data: shape=(20531, 606)
2025-05-26 03:31:21,959 - INFO - Standardizing sample IDs for exp
2025-05-26 03:31:21,975 - INFO - Standardized 606 sample IDs in exp
2025-05-26 03:31:21,977 - INFO - Applying genomic preprocessing for exp
2025-05-26 03:31:22,204 - INFO - Removing 283 constant features from exp
2025-05-26 03:31:22,508 - INFO - Memory optimization for exp: 94.8MB -> 48.0MB (saved 46.8MB)
2025-05-26 03:31:22,509 - INFO - Applying variance filtering to exp, keeping top 5000 features
2025-05-26 03:31:22,693 - INFO - Final exp data: 5000 features x 606 samples
2025-05-26 03:31:22,706 - INFO - Memory usage: 11.8MB
2025-05-26 03:31:22,719 - INFO - exp modality loaded successfully: (5000, 606)
2025-05-26 03:31:22,720 - INFO - [OK] exp: 5000 features x 606 samples
2025-05-26 03:31:22,720 - INFO - === OPTIMIZED SAMPLE INTERSECTION ANALYSIS ===
2025-05-26 03:31:22,721 - INFO - Starting with 985 samples from outcome data
2025-05-26 03:31:22,721 - INFO - Processing mirna: 326 samples
2025-05-26 03:31:22,721 - INFO - After intersecting with mirna: 0 common samples (lost 985)
2025-05-26 03:31:22,721 - INFO - Attempting sample recovery for mirna (lost 985 samples)
2025-05-26 03:31:28,810 - INFO - Fuzzy matching found 727 recoverable samples
2025-05-26 03:31:28,815 - INFO - Pattern matching found 154 additional recoverable samples
2025-05-26 03:31:28,816 - INFO - Processing methy: 480 samples
2025-05-26 03:31:28,817 - INFO - After intersecting with methy: 0 common samples (lost 326)
2025-05-26 03:31:28,817 - INFO - Attempting sample recovery for methy (lost 326 samples)
2025-05-26 03:31:32,307 - INFO - Fuzzy matching found 312 recoverable samples
2025-05-26 03:31:32,324 - INFO - Pattern matching found 39 additional recoverable samples
2025-05-26 03:31:32,327 - INFO - Processing exp: 606 samples
2025-05-26 03:31:32,327 - INFO - After intersecting with exp: 0 common samples (lost 248)
2025-05-26 03:31:32,328 - INFO - Attempting sample recovery for exp (lost 248 samples)
2025-05-26 03:31:35,197 - INFO - Fuzzy matching found 247 recoverable samples
2025-05-26 03:31:35,217 - INFO - Pattern matching found 22 additional recoverable samples
2025-05-26 03:31:35,220 - INFO - Sample recovery successful: 1501 samples recovered across all modalities
2025-05-26 03:31:35,221 - INFO - === FINAL INTERSECTION SUMMARY ===
2025-05-26 03:31:35,221 - INFO - Original outcome samples: 985
2025-05-26 03:31:35,221 - INFO - Final common samples: 244
2025-05-26 03:31:35,221 - INFO - Sample retention rate: 24.8%
2025-05-26 03:31:35,222 - INFO - Filtered mirna: 825 features x 244 samples
2025-05-26 03:31:35,225 - INFO - Filtered methy: 5000 features x 244 samples
2025-05-26 03:31:35,227 - INFO - Filtered exp: 5000 features x 244 samples
2025-05-26 03:31:35,227 - INFO - Sample retention: 24.8% - Expected low sample retention for this dataset type
2025-05-26 03:31:35,227 - INFO - \n=== FINAL DATASET STATISTICS ===
2025-05-26 03:31:35,227 - INFO - Common samples found: 244
2025-05-26 03:31:35,227 - INFO - Modalities loaded: ['mirna', 'methy', 'exp']
2025-05-26 03:31:35,228 - INFO - Sample retention rate: 24.8%
2025-05-26 03:31:35,228 - INFO - \n=== CLASS DISTRIBUTION OPTIMIZATION ===
2025-05-26 03:31:35,229 - INFO - Original class distribution: {'T1a': 55, 'T3a': 51, 'T1b': 49, 'T3b': 29, 'T2': 28, 'T1': 15, 'T4': 6, 'T2a': 6, 'T3': 4, 'T2b': 1}
2025-05-26 03:31:35,230 - INFO - Classes with <5 samples: ['T3', 'T2b']
2025-05-26 03:31:35,231 - INFO - Removing classes with <5 samples: ['T3', 'T2b']
2025-05-26 03:31:35,232 - INFO - Optimized class distribution: {'T1a': 55, 'T3a': 51, 'T1b': 49, 'T3b': 29, 'T2': 28, 'T1': 15, 'T4': 6, 'T2a': 6}
2025-05-26 03:31:35,232 - INFO - Samples retained: 239/244 (98.0%)
2025-05-26 03:31:35,232 - INFO - Updating modalities to match optimized sample set: 239 samples
2025-05-26 03:31:35,236 - INFO - Final outcome data filtered to 239 samples matching common_ids
2025-05-26 03:31:35,237 - INFO - Final outcome distribution: {'T1a': 55, 'T3a': 51, 'T1b': 49, 'T3b': 29, 'T2': 28, 'T1': 15, 'T4': 6, 'T2a': 6}
2025-05-26 03:31:35,237 - INFO - Converting string class labels to numeric labels for classification
2025-05-26 03:31:35,238 - INFO - Label mapping: {'T1': 0, 'T1a': 1, 'T1b': 2, 'T2': 3, 'T2a': 4, 'T3a': 5, 'T3b': 6, 'T4': 7}
2025-05-26 03:31:35,238 - INFO - Converted to numeric labels: {1: 55, 5: 51, 2: 49, 6: 29, 3: 28, 0: 15, 7: 6, 4: 6}
2025-05-26 03:31:35,239 - INFO - Classification validation: 8 classes, min class size: 6
2025-05-26 03:31:35,239 - INFO - All classes have >=5 samples - excellent for CV!
2025-05-26 03:31:35,239 - INFO - === DATASET KIDNEY LOADED SUCCESSFULLY ===
2025-05-26 03:31:35,250 - INFO - MAD for Kidney mirna: 0.000000
2025-05-26 03:31:35,285 - INFO - MAD for Kidney methy: 0.152915
2025-05-26 03:31:35,321 - INFO - MAD for Kidney exp: 402.681610
2025-05-26 03:31:35,322 - INFO - Calculating MAD metrics for dataset: Liver
2025-05-26 03:31:35,322 - INFO - === LOADING DATASET: LIVER ===
2025-05-26 03:31:35,322 - INFO - Modalities: ['exp', 'mirna', 'methy']
2025-05-26 03:31:35,323 - INFO - Outcome column: pathologic_T
2025-05-26 03:31:35,323 - INFO - Task type: classification
2025-05-26 03:31:35,323 - INFO - Loading clinical data from: data\clinical\liver.csv
2025-05-26 03:31:35,337 - INFO - Successfully parsed clinical data with strategy 1
2025-05-26 03:31:35,337 - INFO - Clinical data shape: (438, 118)
2025-05-26 03:31:35,337 - INFO - Clinical data columns: ['_EVENT', '_INTEGRATION', '_OS', '_OS_IND', '_OS_UNIT', '_PATIENT', '_RFS', '_RFS_IND', '_RFS_UNIT', '_TIME_TO_EVENT']...
2025-05-26 03:31:35,338 - INFO - Outcome data shape: (438,)
2025-05-26 03:31:35,339 - INFO - Outcome value counts: {'T1': 210, 'T2': 109, 'T3': 56, 'T3a': 33, 'T4': 16, 'T3b': 9, 'TX': 1, 'T2a': 1, 'T2b': 1, '[Discrepancy]': 1}
2025-05-26 03:31:35,340 - INFO - Samples with valid outcomes: 437
2025-05-26 03:31:35,340 - INFO - Loading 3 modalities in parallel...
2025-05-26 03:31:35,341 - INFO - Loading exp modality...
2025-05-26 03:31:35,342 - INFO - Loading mirna modality...
2025-05-26 03:31:35,342 - INFO - Loading methy modality...
2025-05-26 03:31:35,343 - INFO - Detected malformed header in exp, attempting repair
2025-05-26 03:31:35,343 - INFO - Detected malformed header in mirna, attempting repair
2025-05-26 03:31:35,343 - INFO - Attempting to repair malformed exp file
2025-05-26 03:31:35,343 - INFO - Attempting to repair malformed mirna file
2025-05-26 03:31:35,344 - INFO - Detected malformed header in methy, attempting repair
2025-05-26 03:31:35,344 - INFO - Attempting to repair malformed exp file: data\liver\exp.csv
2025-05-26 03:31:35,344 - INFO - Attempting to repair malformed mirna file: data\liver\mirna.csv
2025-05-26 03:31:35,344 - INFO - Attempting to repair malformed methy file
2025-05-26 03:31:35,345 - INFO - Attempting to repair malformed methy file: data\liver\methy.csv
2025-05-26 03:31:35,370 - INFO - Found 424 sample IDs in malformed header
2025-05-26 03:31:35,543 - INFO - Successfully repaired malformed mirna file: (1046, 424)
2025-05-26 03:31:35,545 - INFO - Data quality check for mirna: PASS - No issues found
2025-05-26 03:31:35,546 - INFO - Loaded mirna data: shape=(1046, 424)
2025-05-26 03:31:35,547 - INFO - Standardizing sample IDs for mirna
2025-05-26 03:31:35,549 - INFO - Standardized 424 sample IDs in mirna
2025-05-26 03:31:35,551 - INFO - Applying genomic preprocessing for mirna
2025-05-26 03:31:35,563 - INFO - Removing 192 constant features from mirna
2025-05-26 03:31:35,566 - INFO - Applying log2(x+1) transformation to mirna
2025-05-26 03:31:35,720 - INFO - Found 429 sample IDs in malformed header
2025-05-26 03:31:35,816 - INFO - Memory optimization for mirna: 2.8MB -> 1.4MB (saved 1.4MB)
2025-05-26 03:31:35,817 - INFO - Final mirna data: 854 features x 424 samples
2025-05-26 03:31:35,821 - INFO - Memory usage: 1.4MB
2025-05-26 03:31:35,839 - INFO - mirna modality loaded successfully: (854, 424)
2025-05-26 03:31:35,840 - INFO - [OK] mirna: 854 features x 424 samples
2025-05-26 03:31:35,900 - INFO - Found 423 sample IDs in malformed header
2025-05-26 03:31:37,463 - INFO - Successfully repaired malformed methy file: (5000, 429)
2025-05-26 03:31:37,469 - INFO - Data quality check for methy: PASS - No issues found
2025-05-26 03:31:37,469 - INFO - Loaded methy data: shape=(5000, 429)
2025-05-26 03:31:37,470 - INFO - Standardizing sample IDs for methy
2025-05-26 03:31:37,476 - INFO - Standardized 429 sample IDs in methy
2025-05-26 03:31:37,477 - INFO - Applying genomic preprocessing for methy
2025-05-26 03:31:37,695 - INFO - Memory optimization for methy: 16.8MB -> 8.6MB (saved 8.2MB)
2025-05-26 03:31:37,696 - INFO - Final methy data: 5000 features x 429 samples
2025-05-26 03:31:37,700 - INFO - Memory usage: 8.6MB
2025-05-26 03:31:37,716 - INFO - methy modality loaded successfully: (5000, 429)
2025-05-26 03:31:37,717 - INFO - [OK] methy: 5000 features x 429 samples
2025-05-26 03:31:38,869 - INFO - Successfully repaired malformed exp file: (20531, 423)
2025-05-26 03:31:38,885 - INFO - Data quality check for exp: PASS - No issues found
2025-05-26 03:31:38,885 - INFO - Loaded exp data: shape=(20531, 423)
2025-05-26 03:31:38,886 - INFO - Standardizing sample IDs for exp
2025-05-26 03:31:38,897 - INFO - Standardized 423 sample IDs in exp
2025-05-26 03:31:38,900 - INFO - Applying genomic preprocessing for exp
2025-05-26 03:31:39,031 - INFO - Removing 362 constant features from exp
2025-05-26 03:31:39,168 - INFO - Memory optimization for exp: 66.3MB -> 33.7MB (saved 32.5MB)
2025-05-26 03:31:39,168 - INFO - Applying variance filtering to exp, keeping top 5000 features
2025-05-26 03:31:39,292 - INFO - Final exp data: 5000 features x 423 samples
2025-05-26 03:31:39,298 - INFO - Memory usage: 8.4MB
2025-05-26 03:31:39,308 - INFO - exp modality loaded successfully: (5000, 423)
2025-05-26 03:31:39,308 - INFO - [OK] exp: 5000 features x 423 samples
2025-05-26 03:31:39,308 - INFO - === OPTIMIZED SAMPLE INTERSECTION ANALYSIS ===
2025-05-26 03:31:39,308 - INFO - Starting with 437 samples from outcome data
2025-05-26 03:31:39,308 - INFO - Processing mirna: 424 samples
2025-05-26 03:31:39,309 - INFO - After intersecting with mirna: 423 common samples (lost 14)
2025-05-26 03:31:39,309 - INFO - Processing methy: 429 samples
2025-05-26 03:31:39,309 - INFO - After intersecting with methy: 414 common samples (lost 9)
2025-05-26 03:31:39,309 - INFO - Processing exp: 423 samples
2025-05-26 03:31:39,309 - INFO - After intersecting with exp: 409 common samples (lost 5)
2025-05-26 03:31:39,309 - INFO - === FINAL INTERSECTION SUMMARY ===
2025-05-26 03:31:39,309 - INFO - Original outcome samples: 437
2025-05-26 03:31:39,309 - INFO - Final common samples: 409
2025-05-26 03:31:39,310 - INFO - Sample retention rate: 93.6%
2025-05-26 03:31:39,314 - INFO - Filtered mirna: 854 features x 409 samples
2025-05-26 03:31:39,323 - INFO - Filtered methy: 5000 features x 409 samples
2025-05-26 03:31:39,332 - INFO - Filtered exp: 5000 features x 409 samples
2025-05-26 03:31:39,333 - INFO - EXCELLENT sample retention achieved!
2025-05-26 03:31:39,333 - INFO - \n=== FINAL DATASET STATISTICS ===
2025-05-26 03:31:39,333 - INFO - Common samples found: 409
2025-05-26 03:31:39,333 - INFO - Modalities loaded: ['mirna', 'methy', 'exp']
2025-05-26 03:31:39,333 - INFO - Sample retention rate: 93.6%
2025-05-26 03:31:39,333 - INFO - \n=== CLASS DISTRIBUTION OPTIMIZATION ===
2025-05-26 03:31:39,334 - INFO - Original class distribution: {'T1': 199, 'T2': 102, 'T3': 50, 'T3a': 31, 'T4': 16, 'T3b': 7, 'TX': 1, 'T2a': 1, 'T2b': 1, '[Discrepancy]': 1}
2025-05-26 03:31:39,335 - INFO - Classes with <5 samples: ['TX', 'T2a', 'T2b', '[Discrepancy]']
2025-05-26 03:31:39,335 - INFO - Merged ['T2a', 'T2b'] -> T2
2025-05-26 03:31:39,336 - INFO - Removing classes with <5 samples: ['TX', '[Discrepancy]']
2025-05-26 03:31:39,336 - INFO - Optimized class distribution: {'T1': 199, 'T2': 104, 'T3': 50, 'T3a': 31, 'T4': 16, 'T3b': 7}
2025-05-26 03:31:39,336 - INFO - Samples retained: 407/409 (99.5%)
2025-05-26 03:31:39,336 - INFO - Updating modalities to match optimized sample set: 407 samples
2025-05-26 03:31:39,418 - INFO - Final outcome data filtered to 407 samples matching common_ids
2025-05-26 03:31:39,419 - INFO - Final outcome distribution: {'T1': 199, 'T2': 104, 'T3': 50, 'T3a': 31, 'T4': 16, 'T3b': 7}
2025-05-26 03:31:39,420 - INFO - Converting string class labels to numeric labels for classification
2025-05-26 03:31:39,420 - INFO - Label mapping: {'T1': 0, 'T2': 1, 'T3': 2, 'T3a': 3, 'T3b': 4, 'T4': 5}
2025-05-26 03:31:39,421 - INFO - Converted to numeric labels: {0: 199, 1: 104, 2: 50, 3: 31, 5: 16, 4: 7}
2025-05-26 03:31:39,421 - INFO - Classification validation: 6 classes, min class size: 7
2025-05-26 03:31:39,421 - INFO - All classes have >=5 samples - excellent for CV!
2025-05-26 03:31:39,421 - INFO - === DATASET LIVER LOADED SUCCESSFULLY ===
2025-05-26 03:31:39,432 - INFO - MAD for Liver mirna: 0.249058
2025-05-26 03:31:39,487 - INFO - MAD for Liver methy: 0.262679
2025-05-26 03:31:39,539 - INFO - MAD for Liver exp: 494.092194
2025-05-26 03:31:39,543 - INFO - Calculating MAD metrics for dataset: Lung
2025-05-26 03:31:39,544 - INFO - === LOADING DATASET: LUNG ===
2025-05-26 03:31:39,544 - INFO - Modalities: ['exp', 'mirna', 'methy']
2025-05-26 03:31:39,544 - INFO - Outcome column: pathologic_T
2025-05-26 03:31:39,544 - INFO - Task type: classification
2025-05-26 03:31:39,544 - INFO - Loading clinical data from: data\clinical\lung.csv
2025-05-26 03:31:39,560 - INFO - Successfully parsed clinical data with strategy 1
2025-05-26 03:31:39,561 - INFO - Clinical data shape: (626, 126)
2025-05-26 03:31:39,561 - INFO - Clinical data columns: ['_EVENT', '_INTEGRATION', '_OS', '_OS_IND', '_OS_UNIT', '_PANCAN_CNA_PANCAN_K8', '_PANCAN_Cluster_Cluster_PANCAN', '_PANCAN_DNAMethyl_LUSC', '_PANCAN_DNAMethyl_PANCAN', '_PANCAN_RPPA_PANCAN_K8']...
2025-05-26 03:31:39,561 - INFO - Outcome data shape: (626,)
2025-05-26 03:31:39,562 - INFO - Outcome value counts: {'T2': 218, 'T2a': 112, 'T3': 81, 'T1': 61, 'T1b': 51, 'T2b': 42, 'T4': 30, 'T1a': 28}
2025-05-26 03:31:39,562 - INFO - Samples with valid outcomes: 623
2025-05-26 03:31:39,562 - INFO - Loading 3 modalities in parallel...
2025-05-26 03:31:39,563 - INFO - Loading exp modality...
2025-05-26 03:31:39,564 - INFO - Loading mirna modality...
2025-05-26 03:31:39,564 - INFO - Loading methy modality...
2025-05-26 03:31:39,564 - INFO - Detected malformed header in exp, attempting repair
2025-05-26 03:31:39,565 - INFO - Attempting to repair malformed exp file
2025-05-26 03:31:39,565 - INFO - Attempting to repair malformed exp file: data\lung\exp.csv
2025-05-26 03:31:39,566 - INFO - Detected malformed header in methy, attempting repair
2025-05-26 03:31:39,567 - INFO - Attempting to repair malformed methy file
2025-05-26 03:31:39,567 - INFO - Attempting to repair malformed methy file: data\lung\methy.csv
2025-05-26 03:31:39,567 - INFO - Detected malformed header in mirna, attempting repair
2025-05-26 03:31:39,567 - INFO - Attempting to repair malformed mirna file
2025-05-26 03:31:39,568 - INFO - Attempting to repair malformed mirna file: data\lung\mirna.csv
2025-05-26 03:31:39,587 - INFO - Found 387 sample IDs in malformed header
2025-05-26 03:31:39,707 - INFO - Successfully repaired malformed mirna file: (1046, 387)
2025-05-26 03:31:39,709 - INFO - Data quality check for mirna: PASS - No issues found
2025-05-26 03:31:39,709 - INFO - Loaded mirna data: shape=(1046, 387)
2025-05-26 03:31:39,710 - INFO - Standardizing sample IDs for mirna
2025-05-26 03:31:39,711 - INFO - Standardized 387 sample IDs in mirna
2025-05-26 03:31:39,711 - INFO - Applying genomic preprocessing for mirna
2025-05-26 03:31:39,718 - INFO - Removing 160 constant features from mirna
2025-05-26 03:31:39,720 - INFO - Applying log2(x+1) transformation to mirna
2025-05-26 03:31:39,806 - INFO - Found 412 sample IDs in malformed header
2025-05-26 03:31:39,878 - INFO - Memory optimization for mirna: 2.7MB -> 1.4MB (saved 1.3MB)
2025-05-26 03:31:39,879 - INFO - Final mirna data: 886 features x 387 samples
2025-05-26 03:31:39,881 - INFO - Memory usage: 1.4MB
2025-05-26 03:31:39,893 - INFO - mirna modality loaded successfully: (886, 387)
2025-05-26 03:31:39,894 - INFO - [OK] mirna: 886 features x 387 samples
2025-05-26 03:31:40,137 - INFO - Found 552 sample IDs in malformed header
2025-05-26 03:31:41,006 - INFO - Successfully repaired malformed methy file: (5000, 412)
2025-05-26 03:31:41,010 - INFO - Data quality check for methy: PASS - No issues found
2025-05-26 03:31:41,010 - INFO - Loaded methy data: shape=(5000, 412)
2025-05-26 03:31:41,011 - INFO - Standardizing sample IDs for methy
2025-05-26 03:31:41,016 - INFO - Standardized 412 sample IDs in methy
2025-05-26 03:31:41,017 - INFO - Applying genomic preprocessing for methy
2025-05-26 03:31:41,198 - INFO - Memory optimization for methy: 16.1MB -> 8.3MB (saved 7.9MB)
2025-05-26 03:31:41,198 - INFO - Final methy data: 5000 features x 412 samples
2025-05-26 03:31:41,202 - INFO - Memory usage: 8.3MB
2025-05-26 03:31:41,215 - INFO - methy modality loaded successfully: (5000, 412)
2025-05-26 03:31:41,215 - INFO - [OK] methy: 5000 features x 412 samples
2025-05-26 03:31:42,719 - INFO - Successfully repaired malformed exp file: (20531, 552)
2025-05-26 03:31:42,736 - INFO - Data quality check for exp: PASS - No issues found
2025-05-26 03:31:42,736 - INFO - Loaded exp data: shape=(20531, 552)
2025-05-26 03:31:42,737 - INFO - Standardizing sample IDs for exp
2025-05-26 03:31:42,755 - INFO - Standardized 552 sample IDs in exp
2025-05-26 03:31:42,757 - INFO - Applying genomic preprocessing for exp
2025-05-26 03:31:42,952 - INFO - Removing 287 constant features from exp
2025-05-26 03:31:43,148 - INFO - Memory optimization for exp: 86.4MB -> 43.8MB (saved 42.6MB)
2025-05-26 03:31:43,148 - INFO - Applying variance filtering to exp, keeping top 5000 features
2025-05-26 03:31:43,339 - INFO - Final exp data: 5000 features x 552 samples
2025-05-26 03:31:43,350 - INFO - Memory usage: 10.8MB
2025-05-26 03:31:43,365 - INFO - exp modality loaded successfully: (5000, 552)
2025-05-26 03:31:43,366 - INFO - [OK] exp: 5000 features x 552 samples
2025-05-26 03:31:43,367 - INFO - === OPTIMIZED SAMPLE INTERSECTION ANALYSIS ===
2025-05-26 03:31:43,367 - INFO - Starting with 623 samples from outcome data
2025-05-26 03:31:43,367 - INFO - Processing mirna: 387 samples
2025-05-26 03:31:43,368 - INFO - After intersecting with mirna: 387 common samples (lost 236)
2025-05-26 03:31:43,368 - INFO - Attempting sample recovery for mirna (lost 236 samples)
2025-05-26 03:31:44,807 - INFO - Fuzzy matching found 158 recoverable samples
2025-05-26 03:31:44,813 - INFO - Pattern matching found 31 additional recoverable samples
2025-05-26 03:31:44,814 - INFO - Processing methy: 412 samples
2025-05-26 03:31:44,814 - INFO - After intersecting with methy: 318 common samples (lost 69)
2025-05-26 03:31:44,815 - INFO - Attempting sample recovery for methy (lost 69 samples)
2025-05-26 03:31:45,243 - INFO - Fuzzy matching found 65 recoverable samples
2025-05-26 03:31:45,255 - INFO - Pattern matching found 34 additional recoverable samples
2025-05-26 03:31:45,257 - INFO - Processing exp: 552 samples
2025-05-26 03:31:45,258 - INFO - After intersecting with exp: 335 common samples (lost 10)
2025-05-26 03:31:45,258 - INFO - Sample recovery successful: 288 samples recovered across all modalities
2025-05-26 03:31:45,258 - INFO - === FINAL INTERSECTION SUMMARY ===
2025-05-26 03:31:45,259 - INFO - Original outcome samples: 623
2025-05-26 03:31:45,259 - INFO - Final common samples: 335
2025-05-26 03:31:45,259 - INFO - Sample retention rate: 53.8%
2025-05-26 03:31:45,260 - INFO - Filtered mirna: 886 features x 335 samples
2025-05-26 03:31:45,261 - INFO - Filtered methy: 5000 features x 335 samples
2025-05-26 03:31:45,267 - INFO - Filtered exp: 5000 features x 335 samples
2025-05-26 03:31:45,267 - WARNING - MODERATE SAMPLE RETENTION detected!
2025-05-26 03:31:45,267 - INFO - MODERATE sample retention detected (this is normal for TCGA data)
2025-05-26 03:31:45,267 - INFO - EXPLANATION: Sample loss occurs due to:
2025-05-26 03:31:45,267 - INFO - 1. ID format differences between clinical and expression data
2025-05-26 03:31:45,268 - INFO - 2. Malformed data files requiring repair
2025-05-26 03:31:45,268 - INFO - 3. Quality filtering and class optimization
2025-05-26 03:31:45,268 - INFO - The system has already applied advanced recovery strategies
2025-05-26 03:31:45,268 - INFO - \n=== FINAL DATASET STATISTICS ===
2025-05-26 03:31:45,268 - INFO - Common samples found: 335
2025-05-26 03:31:45,268 - INFO - Modalities loaded: ['mirna', 'methy', 'exp']
2025-05-26 03:31:45,268 - INFO - Sample retention rate: 53.8%
2025-05-26 03:31:45,268 - INFO - \n=== CLASS DISTRIBUTION OPTIMIZATION ===
2025-05-26 03:31:45,269 - INFO - Original class distribution: {'T2': 87, 'T2a': 69, 'T3': 58, 'T1b': 30, 'T2b': 30, 'T1': 27, 'T1a': 21, 'T4': 13}
2025-05-26 03:31:45,270 - INFO - All classes have sufficient samples for CV
2025-05-26 03:31:45,270 - INFO - Final outcome data filtered to 335 samples matching common_ids
2025-05-26 03:31:45,270 - INFO - Final outcome distribution: {'T2': 87, 'T2a': 69, 'T3': 58, 'T1b': 30, 'T2b': 30, 'T1': 27, 'T1a': 21, 'T4': 13}
2025-05-26 03:31:45,271 - INFO - Converting string class labels to numeric labels for classification
2025-05-26 03:31:45,271 - INFO - Label mapping: {'T1': 0, 'T1a': 1, 'T1b': 2, 'T2': 3, 'T2a': 4, 'T2b': 5, 'T3': 6, 'T4': 7}
2025-05-26 03:31:45,272 - INFO - Converted to numeric labels: {3: 87, 4: 69, 6: 58, 2: 30, 5: 30, 0: 27, 1: 21, 7: 13}
2025-05-26 03:31:45,272 - INFO - Classification validation: 8 classes, min class size: 13
2025-05-26 03:31:45,272 - INFO - All classes have >=5 samples - excellent for CV!
2025-05-26 03:31:45,272 - INFO - === DATASET LUNG LOADED SUCCESSFULLY ===
2025-05-26 03:31:45,280 - INFO - MAD for Lung mirna: 0.294200
2025-05-26 03:31:45,319 - INFO - MAD for Lung methy: 0.184320
2025-05-26 03:31:45,359 - INFO - MAD for Lung exp: 451.034851
2025-05-26 03:31:45,362 - INFO - Calculating MAD metrics for dataset: Melanoma
2025-05-26 03:31:45,362 - INFO - === LOADING DATASET: MELANOMA ===
2025-05-26 03:31:45,363 - INFO - Modalities: ['exp', 'mirna', 'methy']
2025-05-26 03:31:45,363 - INFO - Outcome column: pathologic_T
2025-05-26 03:31:45,363 - INFO - Task type: classification
2025-05-26 03:31:45,363 - INFO - Loading clinical data from: data\clinical\melanoma.csv
2025-05-26 03:31:45,377 - INFO - Successfully parsed clinical data with strategy 1
2025-05-26 03:31:45,377 - INFO - Clinical data shape: (481, 102)
2025-05-26 03:31:45,377 - INFO - Clinical data columns: ['_EVENT', '_INTEGRATION', '_OS', '_OS_IND', '_OS_UNIT', '_PATIENT', '_RFS', '_RFS_IND', '_RFS_UNIT', '_TIME_TO_EVENT']...
2025-05-26 03:31:45,378 - INFO - Outcome data shape: (481,)
2025-05-26 03:31:45,378 - INFO - Outcome value counts: {'T4b': 114, 'TX': 48, 'T3b': 39, 'T3a': 39, 'T2a': 32, 'T2': 32, 'T4a': 26, 'T0': 23, 'T1a': 22, 'T4': 16, 'T2b': 15, 'T3': 15, 'T1b': 10, 'T1': 10, 'Tis': 8}
2025-05-26 03:31:45,378 - INFO - Samples with valid outcomes: 449
2025-05-26 03:31:45,379 - INFO - Loading 3 modalities in parallel...
2025-05-26 03:31:45,379 - INFO - Loading exp modality...
2025-05-26 03:31:45,380 - INFO - Loading mirna modality...
2025-05-26 03:31:45,382 - INFO - Loading methy modality...
2025-05-26 03:31:45,382 - INFO - Detected malformed header in exp, attempting repair
2025-05-26 03:31:45,383 - INFO - Attempting to repair malformed exp file
2025-05-26 03:31:45,383 - INFO - Attempting to repair malformed exp file: data\melanoma\exp.csv
2025-05-26 03:31:45,383 - INFO - Detected malformed header in mirna, attempting repair
2025-05-26 03:31:45,383 - INFO - Detected malformed header in methy, attempting repair
2025-05-26 03:31:45,384 - INFO - Attempting to repair malformed mirna file
2025-05-26 03:31:45,384 - INFO - Attempting to repair malformed methy file
2025-05-26 03:31:45,384 - INFO - Attempting to repair malformed mirna file: data\melanoma\mirna.csv
2025-05-26 03:31:45,384 - INFO - Attempting to repair malformed methy file: data\melanoma\methy.csv
2025-05-26 03:31:45,398 - INFO - Found 452 sample IDs in malformed header
2025-05-26 03:31:45,560 - INFO - Successfully repaired malformed mirna file: (1046, 452)
2025-05-26 03:31:45,562 - INFO - Data quality check for mirna: PASS - No issues found
2025-05-26 03:31:45,562 - INFO - Loaded mirna data: shape=(1046, 452)
2025-05-26 03:31:45,563 - INFO - Standardizing sample IDs for mirna
2025-05-26 03:31:45,564 - INFO - Standardized 452 sample IDs in mirna
2025-05-26 03:31:45,565 - INFO - Applying genomic preprocessing for mirna
2025-05-26 03:31:45,575 - INFO - Removing 145 constant features from mirna
2025-05-26 03:31:45,578 - INFO - Applying log2(x+1) transformation to mirna
2025-05-26 03:31:45,669 - INFO - Found 475 sample IDs in malformed header
2025-05-26 03:31:45,852 - INFO - Memory optimization for mirna: 3.2MB -> 1.6MB (saved 1.6MB)
2025-05-26 03:31:45,853 - INFO - Final mirna data: 901 features x 452 samples
2025-05-26 03:31:45,856 - INFO - Memory usage: 1.6MB
2025-05-26 03:31:45,874 - INFO - mirna modality loaded successfully: (901, 452)
2025-05-26 03:31:45,875 - INFO - [OK] mirna: 901 features x 452 samples
2025-05-26 03:31:45,966 - INFO - Found 473 sample IDs in malformed header
2025-05-26 03:31:47,354 - INFO - Successfully repaired malformed methy file: (5000, 475)
2025-05-26 03:31:47,360 - INFO - Data quality check for methy: PASS - No issues found
2025-05-26 03:31:47,360 - INFO - Loaded methy data: shape=(5000, 475)
2025-05-26 03:31:47,361 - INFO - Standardizing sample IDs for methy
2025-05-26 03:31:47,366 - INFO - Standardized 475 sample IDs in methy
2025-05-26 03:31:47,367 - INFO - Applying genomic preprocessing for methy
2025-05-26 03:31:47,888 - INFO - Memory optimization for methy: 18.5MB -> 9.5MB (saved 9.1MB)
2025-05-26 03:31:47,888 - INFO - Final methy data: 5000 features x 475 samples
2025-05-26 03:31:47,891 - INFO - Memory usage: 9.5MB
2025-05-26 03:31:47,904 - INFO - methy modality loaded successfully: (5000, 475)
2025-05-26 03:31:47,904 - INFO - [OK] methy: 5000 features x 475 samples
2025-05-26 03:31:48,571 - INFO - Successfully repaired malformed exp file: (20531, 473)
2025-05-26 03:31:48,586 - INFO - Data quality check for exp: PASS - No issues found
2025-05-26 03:31:48,586 - INFO - Loaded exp data: shape=(20531, 473)
2025-05-26 03:31:48,587 - INFO - Standardizing sample IDs for exp
2025-05-26 03:31:48,603 - INFO - Standardized 473 sample IDs in exp
2025-05-26 03:31:48,604 - INFO - Applying genomic preprocessing for exp
2025-05-26 03:31:48,764 - INFO - Removing 303 constant features from exp
2025-05-26 03:31:48,919 - INFO - Memory optimization for exp: 74.2MB -> 37.7MB (saved 36.5MB)
2025-05-26 03:31:48,920 - INFO - Applying variance filtering to exp, keeping top 5000 features
2025-05-26 03:31:49,082 - INFO - Final exp data: 5000 features x 473 samples
2025-05-26 03:31:49,090 - INFO - Memory usage: 9.3MB
2025-05-26 03:31:49,102 - INFO - exp modality loaded successfully: (5000, 473)
2025-05-26 03:31:49,103 - INFO - [OK] exp: 5000 features x 473 samples
2025-05-26 03:31:49,103 - INFO - === OPTIMIZED SAMPLE INTERSECTION ANALYSIS ===
2025-05-26 03:31:49,103 - INFO - Starting with 449 samples from outcome data
2025-05-26 03:31:49,104 - INFO - Processing mirna: 452 samples
2025-05-26 03:31:49,104 - INFO - After intersecting with mirna: 423 common samples (lost 26)
2025-05-26 03:31:49,104 - INFO - Processing methy: 475 samples
2025-05-26 03:31:49,104 - INFO - After intersecting with methy: 422 common samples (lost 1)
2025-05-26 03:31:49,104 - INFO - Processing exp: 473 samples
2025-05-26 03:31:49,105 - INFO - After intersecting with exp: 421 common samples (lost 1)
2025-05-26 03:31:49,105 - INFO - === FINAL INTERSECTION SUMMARY ===
2025-05-26 03:31:49,105 - INFO - Original outcome samples: 449
2025-05-26 03:31:49,105 - INFO - Final common samples: 421
2025-05-26 03:31:49,105 - INFO - Sample retention rate: 93.8%
2025-05-26 03:31:49,110 - INFO - Filtered mirna: 901 features x 421 samples
2025-05-26 03:31:49,120 - INFO - Filtered methy: 5000 features x 421 samples
2025-05-26 03:31:49,129 - INFO - Filtered exp: 5000 features x 421 samples
2025-05-26 03:31:49,130 - INFO - EXCELLENT sample retention achieved!
2025-05-26 03:31:49,130 - INFO - \n=== FINAL DATASET STATISTICS ===
2025-05-26 03:31:49,130 - INFO - Common samples found: 421
2025-05-26 03:31:49,130 - INFO - Modalities loaded: ['mirna', 'methy', 'exp']
2025-05-26 03:31:49,130 - INFO - Sample retention rate: 93.8%
2025-05-26 03:31:49,130 - INFO - \n=== CLASS DISTRIBUTION OPTIMIZATION ===
2025-05-26 03:31:49,131 - INFO - Original class distribution: {'T4b': 106, 'TX': 46, 'T3b': 36, 'T3a': 36, 'T2a': 32, 'T2': 32, 'T4a': 23, 'T0': 23, 'T1a': 20, 'T2b': 15, 'T4': 14, 'T3': 12, 'T1b': 9, 'T1': 9, 'Tis': 8}
2025-05-26 03:31:49,132 - INFO - All classes have sufficient samples for CV
2025-05-26 03:31:49,132 - INFO - Final outcome data filtered to 421 samples matching common_ids
2025-05-26 03:31:49,133 - INFO - Final outcome distribution: {'T4b': 106, 'TX': 46, 'T3b': 36, 'T3a': 36, 'T2a': 32, 'T2': 32, 'T4a': 23, 'T0': 23, 'T1a': 20, 'T2b': 15, 'T4': 14, 'T3': 12, 'T1b': 9, 'T1': 9, 'Tis': 8}
2025-05-26 03:31:49,133 - INFO - Converting string class labels to numeric labels for classification
2025-05-26 03:31:49,134 - INFO - Label mapping: {'T0': 0, 'T1': 1, 'T1a': 2, 'T1b': 3, 'T2': 4, 'T2a': 5, 'T2b': 6, 'T3': 7, 'T3a': 8, 'T3b': 9, 'T4': 10, 'T4a': 11, 'T4b': 12, 'TX': 13, 'Tis': 14}
2025-05-26 03:31:49,134 - INFO - Converted to numeric labels: {12: 106, 13: 46, 9: 36, 8: 36, 5: 32, 4: 32, 11: 23, 0: 23, 2: 20, 6: 15, 10: 14, 7: 12, 3: 9, 1: 9, 14: 8}
2025-05-26 03:31:49,135 - INFO - Classification validation: 15 classes, min class size: 8
2025-05-26 03:31:49,135 - INFO - All classes have >=5 samples - excellent for CV!
2025-05-26 03:31:49,135 - INFO - === DATASET MELANOMA LOADED SUCCESSFULLY ===
2025-05-26 03:31:49,146 - INFO - MAD for Melanoma mirna: 0.341615
2025-05-26 03:31:49,210 - INFO - MAD for Melanoma methy: 0.242343
2025-05-26 03:31:49,266 - INFO - MAD for Melanoma exp: 475.096741
2025-05-26 03:31:49,270 - INFO - Calculating MAD metrics for dataset: Ovarian
2025-05-26 03:31:49,270 - INFO - === LOADING DATASET: OVARIAN ===
2025-05-26 03:31:49,270 - INFO - Modalities: ['exp', 'mirna', 'methy']
2025-05-26 03:31:49,271 - INFO - Outcome column: clinical_stage
2025-05-26 03:31:49,271 - INFO - Task type: classification
2025-05-26 03:31:49,271 - INFO - Loading clinical data from: data\clinical\ovarian.csv
2025-05-26 03:31:49,283 - INFO - Successfully parsed clinical data with strategy 1
2025-05-26 03:31:49,283 - INFO - Clinical data shape: (630, 110)
2025-05-26 03:31:49,283 - INFO - Clinical data columns: ['_EVENT', '_INTEGRATION', '_OS', '_OS_IND', '_OS_UNIT', '_PANCAN_CNA_PANCAN_K8', '_PANCAN_Cluster_Cluster_PANCAN', '_PANCAN_DNAMethyl_PANCAN', '_PANCAN_RPPA_PANCAN_K8', '_PANCAN_UNC_RNAseq_PANCAN_K16']...
2025-05-26 03:31:49,284 - INFO - Outcome data shape: (630,)
2025-05-26 03:31:49,285 - INFO - Outcome value counts: {'Stage IIIC': 429, 'Stage IV': 89, 'Stage IIIB': 25, 'Stage IIC': 24, 'Stage IC': 11, 'Stage IIIA': 8, 'Stage IIB': 5, 'Stage IA': 4, 'Stage IIA': 4, 'Stage IB': 3}
2025-05-26 03:31:49,285 - INFO - Samples with valid outcomes: 602
2025-05-26 03:31:49,285 - INFO - Loading 3 modalities in parallel...
2025-05-26 03:31:49,285 - INFO - Loading exp modality...
2025-05-26 03:31:49,285 - INFO - Loading mirna modality...
2025-05-26 03:31:49,285 - INFO - Loading methy modality...
2025-05-26 03:31:49,304 - INFO - Detected malformed header in exp, attempting repair
2025-05-26 03:31:49,304 - INFO - Attempting to repair malformed exp file
2025-05-26 03:31:49,304 - INFO - Attempting to repair malformed exp file: data\ovarian\exp.csv
2025-05-26 03:31:49,306 - INFO - Detected malformed header in mirna, attempting repair
2025-05-26 03:31:49,306 - INFO - Attempting to repair malformed mirna file
2025-05-26 03:31:49,306 - INFO - Attempting to repair malformed mirna file: data\ovarian\mirna.csv
2025-05-26 03:31:49,307 - INFO - Detected malformed header in methy, attempting repair
2025-05-26 03:31:49,307 - INFO - Attempting to repair malformed methy file
2025-05-26 03:31:49,308 - INFO - Attempting to repair malformed methy file: data\ovarian\methy.csv
2025-05-26 03:31:49,320 - INFO - Found 461 sample IDs in malformed header
2025-05-26 03:31:49,478 - INFO - Successfully repaired malformed mirna file: (705, 461)
2025-05-26 03:31:49,480 - INFO - Data quality check for mirna: PASS - No issues found
2025-05-26 03:31:49,480 - INFO - Loaded mirna data: shape=(705, 461)
2025-05-26 03:31:49,481 - INFO - Standardizing sample IDs for mirna
2025-05-26 03:31:49,483 - INFO - Standardized 461 sample IDs in mirna
2025-05-26 03:31:49,483 - INFO - Applying genomic preprocessing for mirna
2025-05-26 03:31:49,493 - INFO - Removing 82 constant features from mirna
2025-05-26 03:31:49,495 - INFO - Applying log2(x+1) transformation to mirna
2025-05-26 03:31:49,603 - INFO - Found 307 sample IDs in malformed header
2025-05-26 03:31:49,678 - INFO - Found 612 sample IDs in malformed header
2025-05-26 03:31:49,700 - INFO - Memory optimization for mirna: 2.2MB -> 1.1MB (saved 1.1MB)
2025-05-26 03:31:49,701 - INFO - Final mirna data: 623 features x 461 samples
2025-05-26 03:31:49,703 - INFO - Memory usage: 1.1MB
2025-05-26 03:31:49,711 - INFO - mirna modality loaded successfully: (623, 461)
2025-05-26 03:31:49,711 - INFO - [OK] mirna: 623 features x 461 samples
2025-05-26 03:31:51,332 - INFO - Successfully repaired malformed methy file: (5000, 612)
2025-05-26 03:31:51,337 - INFO - Data quality check for methy: PASS - No issues found
2025-05-26 03:31:51,337 - INFO - Loaded methy data: shape=(5000, 612)
2025-05-26 03:31:51,338 - INFO - Standardizing sample IDs for methy
2025-05-26 03:31:51,343 - INFO - Standardized 612 sample IDs in methy
2025-05-26 03:31:51,344 - INFO - Applying genomic preprocessing for methy
2025-05-26 03:31:51,585 - INFO - Successfully repaired malformed exp file: (20531, 307)
2025-05-26 03:31:51,595 - INFO - Data quality check for exp: PASS - No issues found
2025-05-26 03:31:51,596 - INFO - Loaded exp data: shape=(20531, 307)
2025-05-26 03:31:51,598 - INFO - Standardizing sample IDs for exp
2025-05-26 03:31:51,610 - INFO - Standardized 307 sample IDs in exp
2025-05-26 03:31:51,612 - INFO - Applying genomic preprocessing for exp
2025-05-26 03:31:51,661 - INFO - Memory optimization for methy: 23.8MB -> 12.1MB (saved 11.7MB)
2025-05-26 03:31:51,661 - INFO - Final methy data: 5000 features x 612 samples
2025-05-26 03:31:51,666 - INFO - Memory usage: 12.1MB
2025-05-26 03:31:51,684 - INFO - methy modality loaded successfully: (5000, 612)
2025-05-26 03:31:51,685 - INFO - [OK] methy: 5000 features x 612 samples
2025-05-26 03:31:51,734 - INFO - Removing 343 constant features from exp
2025-05-26 03:31:51,864 - INFO - Memory optimization for exp: 48.5MB -> 24.8MB (saved 23.6MB)
2025-05-26 03:31:51,864 - INFO - Applying variance filtering to exp, keeping top 5000 features
2025-05-26 03:31:51,974 - INFO - Final exp data: 5000 features x 307 samples
2025-05-26 03:31:51,979 - INFO - Memory usage: 6.1MB
2025-05-26 03:31:51,985 - INFO - exp modality loaded successfully: (5000, 307)
2025-05-26 03:31:51,986 - INFO - [OK] exp: 5000 features x 307 samples
2025-05-26 03:31:51,986 - INFO - === OPTIMIZED SAMPLE INTERSECTION ANALYSIS ===
2025-05-26 03:31:51,987 - INFO - Starting with 602 samples from outcome data
2025-05-26 03:31:51,987 - INFO - Processing mirna: 461 samples
2025-05-26 03:31:51,987 - INFO - After intersecting with mirna: 457 common samples (lost 145)
2025-05-26 03:31:51,987 - INFO - Attempting sample recovery for mirna (lost 145 samples)
2025-05-26 03:31:53,009 - INFO - Fuzzy matching found 131 recoverable samples
2025-05-26 03:31:53,014 - INFO - Pattern matching found 13 additional recoverable samples
2025-05-26 03:31:53,016 - INFO - Processing methy: 612 samples
2025-05-26 03:31:53,016 - INFO - After intersecting with methy: 457 common samples (lost 1)
2025-05-26 03:31:53,016 - INFO - Processing exp: 307 samples
2025-05-26 03:31:53,016 - INFO - After intersecting with exp: 251 common samples (lost 206)
2025-05-26 03:31:53,017 - INFO - Attempting sample recovery for exp (lost 206 samples)
2025-05-26 03:31:54,167 - INFO - Fuzzy matching found 205 recoverable samples
2025-05-26 03:31:54,178 - INFO - Pattern matching found 5 additional recoverable samples
2025-05-26 03:31:54,179 - INFO - Sample recovery successful: 354 samples recovered across all modalities
2025-05-26 03:31:54,179 - INFO - === FINAL INTERSECTION SUMMARY ===
2025-05-26 03:31:54,179 - INFO - Original outcome samples: 602
2025-05-26 03:31:54,179 - INFO - Final common samples: 293
2025-05-26 03:31:54,180 - INFO - Sample retention rate: 48.7%
2025-05-26 03:31:54,181 - INFO - Filtered mirna: 623 features x 293 samples
2025-05-26 03:31:54,188 - INFO - Filtered methy: 5000 features x 293 samples
2025-05-26 03:31:54,191 - INFO - Filtered exp: 5000 features x 293 samples
2025-05-26 03:31:54,191 - WARNING - MODERATE SAMPLE RETENTION detected!
2025-05-26 03:31:54,191 - INFO - MODERATE sample retention detected (this is normal for TCGA data)
2025-05-26 03:31:54,191 - INFO - EXPLANATION: Sample loss occurs due to:
2025-05-26 03:31:54,192 - INFO - 1. ID format differences between clinical and expression data
2025-05-26 03:31:54,192 - INFO - 2. Malformed data files requiring repair
2025-05-26 03:31:54,192 - INFO - 3. Quality filtering and class optimization
2025-05-26 03:31:54,192 - INFO - The system has already applied advanced recovery strategies
2025-05-26 03:31:54,192 - INFO - \n=== FINAL DATASET STATISTICS ===
2025-05-26 03:31:54,192 - INFO - Common samples found: 293
2025-05-26 03:31:54,193 - INFO - Modalities loaded: ['mirna', 'methy', 'exp']
2025-05-26 03:31:54,193 - INFO - Sample retention rate: 48.7%
2025-05-26 03:31:54,193 - INFO - \n=== CLASS DISTRIBUTION OPTIMIZATION ===
2025-05-26 03:31:54,194 - INFO - Original class distribution: {'Stage IIIC': 210, 'Stage IV': 39, 'Stage IIC': 16, 'Stage IIIB': 13, 'Stage IIIA': 5, 'Stage IC': 4, 'Stage IIB': 3, 'Stage IA': 2, 'Stage IB': 1}
2025-05-26 03:31:54,194 - INFO - Classes with <5 samples: ['Stage IC', 'Stage IIB', 'Stage IA', 'Stage IB']
2025-05-26 03:31:54,195 - INFO - Removing classes with <5 samples: ['Stage IC', 'Stage IIB', 'Stage IA', 'Stage IB']
2025-05-26 03:31:54,196 - INFO - Optimized class distribution: {'Stage IIIC': 210, 'Stage IV': 39, 'Stage IIC': 16, 'Stage IIIB': 13, 'Stage IIIA': 5}
2025-05-26 03:31:54,196 - INFO - Samples retained: 283/293 (96.6%)
2025-05-26 03:31:54,196 - INFO - Updating modalities to match optimized sample set: 283 samples
2025-05-26 03:31:54,206 - INFO - Final outcome data filtered to 283 samples matching common_ids
2025-05-26 03:31:54,207 - INFO - Final outcome distribution: {'Stage IIIC': 210, 'Stage IV': 39, 'Stage IIC': 16, 'Stage IIIB': 13, 'Stage IIIA': 5}
2025-05-26 03:31:54,208 - INFO - Converting string class labels to numeric labels for classification
2025-05-26 03:31:54,208 - INFO - Label mapping: {'Stage IIC': 0, 'Stage IIIA': 1, 'Stage IIIB': 2, 'Stage IIIC': 3, 'Stage IV': 4}
2025-05-26 03:31:54,208 - INFO - Converted to numeric labels: {3: 210, 4: 39, 0: 16, 2: 13, 1: 5}
2025-05-26 03:31:54,209 - INFO - Classification validation: 5 classes, min class size: 5
2025-05-26 03:31:54,209 - INFO - All classes have >=5 samples - excellent for CV!
2025-05-26 03:31:54,209 - INFO - === DATASET OVARIAN LOADED SUCCESSFULLY ===
2025-05-26 03:31:54,215 - INFO - MAD for Ovarian mirna: 0.479910
2025-05-26 03:31:54,252 - INFO - MAD for Ovarian methy: 0.130152
2025-05-26 03:31:54,289 - INFO - MAD for Ovarian exp: 458.422363
2025-05-26 03:31:54,303 - INFO - Detailed statistics saved to: output\mad_detailed_statistics.csv
2025-05-26 03:31:54,303 - INFO - 
MAD Statistics:
2025-05-26 03:31:54,304 - INFO - ==================================================
2025-05-26 03:31:54,304 - INFO - Dataset  Modality MAD Value   
2025-05-26 03:31:54,304 - INFO - --------------------------------------------------
2025-05-26 03:31:54,305 - INFO - Breast   mirna    0.000000    
2025-05-26 03:31:54,305 - INFO - Kidney   mirna    0.000000    
2025-05-26 03:31:54,305 - INFO - Ovarian  methy    0.130152    
2025-05-26 03:31:54,305 - INFO - Kidney   methy    0.152915    
2025-05-26 03:31:54,305 - INFO - Lung     methy    0.184320    
2025-05-26 03:31:54,305 - INFO - Colon    methy    0.199081    
2025-05-26 03:31:54,306 - INFO - Sarcoma  mirna    0.206104    
2025-05-26 03:31:54,306 - INFO - Breast   methy    0.207285    
2025-05-26 03:31:54,306 - INFO - AML      methy    0.241476    
2025-05-26 03:31:54,306 - INFO - Melanoma methy    0.242343    
2025-05-26 03:31:54,306 - INFO - Liver    mirna    0.249058    
2025-05-26 03:31:54,306 - INFO - Sarcoma  methy    0.250229    
2025-05-26 03:31:54,306 - INFO - Liver    methy    0.262679    
2025-05-26 03:31:54,306 - INFO - Lung     mirna    0.294200    
2025-05-26 03:31:54,307 - INFO - Melanoma mirna    0.341615    
2025-05-26 03:31:54,307 - INFO - Colon    mirna    0.341708    
2025-05-26 03:31:54,307 - INFO - AML      mirna    0.436554    
2025-05-26 03:31:54,307 - INFO - Ovarian  mirna    0.479910    
2025-05-26 03:31:54,307 - INFO - AML      exp      367.234955  
2025-05-26 03:31:54,307 - INFO - Colon    exp      367.757080  
2025-05-26 03:31:54,307 - INFO - Kidney   exp      402.681610  
2025-05-26 03:31:54,308 - INFO - Breast   exp      450.522491  
2025-05-26 03:31:54,308 - INFO - Lung     exp      451.034851  
2025-05-26 03:31:54,308 - INFO - Ovarian  exp      458.422363  
2025-05-26 03:31:54,308 - INFO - Melanoma exp      475.096741  
2025-05-26 03:31:54,308 - INFO - Sarcoma  exp      478.041870  
2025-05-26 03:31:54,309 - INFO - Liver    exp      494.092194  
2025-05-26 03:31:54,309 - INFO - ==================================================
2025-05-26 03:31:54,309 - INFO - 
MAD Summary Statistics:
2025-05-26 03:31:54,309 - INFO - Total dataset-modality combinations: 27
2025-05-26 03:31:54,309 - INFO - Unique datasets: 9
2025-05-26 03:31:54,310 - INFO - Unique modalities: 3
2025-05-26 03:31:54,310 - INFO - 
MAD statistics by modality:
2025-05-26 03:31:54,321 - INFO - 
          count        mean        std         min         max
modality                                                      
exp           9  438.320465  47.510353  367.234955  494.092194
methy         9    0.207831   0.045837    0.130152    0.262679
mirna         9    0.261016   0.170387    0.000000    0.479910
2025-05-26 03:31:54,321 - INFO - 
Step 2: Creating modality-specific critical difference diagrams...
2025-05-26 03:31:54,321 - INFO - Creating EXP modality diagram...
2025-05-26 03:31:54,927 - INFO - EXP critical difference diagram saved to: output\mad_exp_critical_difference_diagram.png
2025-05-26 03:31:54,939 - INFO - Creating miRNA modality diagram...
2025-05-26 03:31:55,425 - INFO - MIRNA critical difference diagram saved to: output\mad_mirna_critical_difference_diagram.png
2025-05-26 03:31:55,432 - INFO - Creating Methylation modality diagram...
2025-05-26 03:31:55,861 - INFO - METHY critical difference diagram saved to: output\mad_methy_critical_difference_diagram.png
2025-05-26 03:31:55,868 - INFO - Skipping all modalities combined diagram (scale incompatibility)
2025-05-26 03:31:55,868 - INFO - MAD analysis pipeline completed successfully!
